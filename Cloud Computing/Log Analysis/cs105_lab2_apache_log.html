<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>cs105_lab2_apache_log - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"dbcForumURL":"http://forums.databricks.com/","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","container_memory_mb":6000,"memory_mb":6144,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableEBSVolumesUIForJobs":false,"enablePublishNotebooks":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Scala 2.11)","packageLabel":"spark-image-2ed723ed81c23b57d4ac31a93a7e2e72a847957bd1a81a173b8e49aba9ff0fb7","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Scala 2.10)","packageLabel":"spark-image-007dd0b32332bffcba261806f005dfd759d17fdbd32b91b2acc2044e8be01919","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"memory-optimized":1,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.27.1","accountsLimit":3,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"useFixedStaticNotebookVersionForDevelopment":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"docsDomain":"https://docs.cloud.databricks.com/","enableWorkspaceAcls":false,"gitHash":"20160901120019","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/A%20Gentle%20Introduction%20to%20Apache%20Spark%20on%20Databricks.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/Quick%20Start%20DataFrames.html","displayName":"Quick Start DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/GSW%20Passing%20Analysis%20(new).html","displayName":"GSW Passing Analysis (new)","icon":"img/home/Python_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":944615974881689,"name":"cs105_lab2_apache_log","language":"python","commands":[{"version":"CommandV1","origId":944615974881691,"guid":"9b08da14-836d-4b1d-8ee2-1800530d2648","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n<a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png\" /></a><br />This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878405E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"42ea9aac-e2dc-4029-8147-87d3b28852cf"},{"version":"CommandV1","origId":944615974881692,"guid":"3f370dd7-4b1a-4c74-8bc5-21766606b508","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n#![Spark Logo](http://spark-mooc.github.io/web-assets/images/ta_Spark-logo-small.png) + ![Python Logo](http://spark-mooc.github.io/web-assets/images/python-logo-master-v3-TM-flattened_small.png)\n# **Web Server Log Analysis with Apache Spark**\n\nThis lab will demonstrate how easy it is to perform web server log analysis with Apache Spark.\n\nServer log analysis is an ideal use case for Spark.  It's a very large, common data source and contains a rich set of information.  Spark allows you to store your logs in files on disk cheaply, while still providing a quick and simple way to perform data analysis on them.  This homework will show you how to use Apache Spark on real-world text-based production logs and fully harness the power of that data.  Log data comes from many sources, such as web, file, and compute servers, application logs, user-generated content,  and can be used for monitoring servers, improving business and customer intelligence, building recommendation systems, fraud detection, and much more.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878406E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ee6d38dc-dd01-4f1c-9b8f-3c6684c3e52c"},{"version":"CommandV1","origId":944615974881693,"guid":"8a0b77d7-a11b-4f04-b8d2-50368a871e93","subtype":"command","commandType":"auto","position":3.0,"command":"labVersion = 'cs105x-lab2-1.1.0'","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681890927E12,"submitTime":1.467681878431E12,"finishTime":1.467681891026E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"770fac73-31d7-4739-ace4-2646f1e312bd"},{"version":"CommandV1","origId":944615974881694,"guid":"ddb71c65-0a56-47a0-a863-884e7e6b6d4b","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n## How to complete this lab\n\nThis lab is broken up into sections with bite-sized examples for demonstrating Spark functionality for log processing.\n\nIt consists of 5 parts:\n* *Part 1:* Introduction and Imports\n* *Part 2:* Exploratory Data Analysis\n* *Part 3*: Analysis Walk-Through on the Web Server Log File\n* *Part 4*: Analyzing Web Server Log File\n* *Part 5*: Exploring 404 Response Codes\n\nAlso, at the very bottom:\n\n* *Appendix A*: Submitting Your Exercises to the Autograder","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878456E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"dc9a798c-1778-41e7-bfce-0cfe88bba06a"},{"version":"CommandV1","origId":944615974881695,"guid":"34c8b63d-d15c-4816-8904-180c5accff13","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Part 1: Introduction and Imports\n\n### A note about DataFrame column references\n\nIn Python, it's possible to access a DataFrame's columns either by attribute (`df.age`) or by indexing (`df['age']`). Referring to a column by attribute (`df.age`) is very Pandas-like, and it's highly convenient, especially when you're doing interactive data exploration. But it can fail, for reasons that aren't obvious. For example:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878482E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c78d716a-0200-45b1-ba75-18e523d1cf0d"},{"version":"CommandV1","origId":944615974881696,"guid":"42974932-f377-479d-b77d-b88a85091b48","subtype":"command","commandType":"auto","position":6.0,"command":"throwaway_df = sqlContext.createDataFrame([('Anthony', 10), ('Julia', 20), ('Fred', 5)], ('name', 'count'))\nthrowaway_df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+-----+\n|   name|count|\n+-------+-----+\n|Anthony|   10|\n|  Julia|   20|\n|   Fred|    5|\n+-------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;function&apos; object has no attribute &apos;_get_object_id&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-1-ff0d35ccf335&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> throwaway_df <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;Anthony&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">10</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;Julia&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">20</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;Fred&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;name&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;count&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>throwaway_df<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span>throwaway_df<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span> <span class=\"ansired\"># This line does not work. Please comment it out later.</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">select</span><span class=\"ansiblue\">(self, *cols)</span>\n<span class=\"ansigreen\">    860</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Alice&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">12</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Bob&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">15</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    861</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 862</span><span class=\"ansiyellow\">         </span>jdf <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jcols<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>cols<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    863</span>         <span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>jdf<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    864</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">_jcols</span><span class=\"ansiblue\">(self, *cols)</span>\n<span class=\"ansigreen\">    718</span>         <span class=\"ansigreen\">if</span> len<span class=\"ansiyellow\">(</span>cols<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">==</span> <span class=\"ansicyan\">1</span> <span class=\"ansigreen\">and</span> isinstance<span class=\"ansiyellow\">(</span>cols<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> list<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    719</span>             cols <span class=\"ansiyellow\">=</span> cols<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 720</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_jseq<span class=\"ansiyellow\">(</span>cols<span class=\"ansiyellow\">,</span> _to_java_column<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    721</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    722</span>     <span class=\"ansigreen\">def</span> _sort_cols<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> cols<span class=\"ansiyellow\">,</span> kwargs<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">_jseq</span><span class=\"ansiblue\">(self, cols, converter)</span>\n<span class=\"ansigreen\">    705</span>     <span class=\"ansigreen\">def</span> _jseq<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> cols<span class=\"ansiyellow\">,</span> converter<span class=\"ansiyellow\">=</span>None<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    706</span>         <span class=\"ansiblue\">&quot;&quot;&quot;Return a JVM Seq of Columns from a list of Column or names&quot;&quot;&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 707</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> _to_seq<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">,</span> cols<span class=\"ansiyellow\">,</span> converter<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    708</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    709</span>     <span class=\"ansigreen\">def</span> _jmap<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> jm<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/column.py</span> in <span class=\"ansicyan\">_to_seq</span><span class=\"ansiblue\">(sc, cols, converter)</span>\n<span class=\"ansigreen\">     58</span>     &quot;&quot;&quot;\n<span class=\"ansigreen\">     59</span>     <span class=\"ansigreen\">if</span> converter<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 60</span><span class=\"ansiyellow\">         </span>cols <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span>converter<span class=\"ansiyellow\">(</span>c<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">for</span> c <span class=\"ansigreen\">in</span> cols<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">return</span> sc<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonUtils<span class=\"ansiyellow\">.</span>toSeq<span class=\"ansiyellow\">(</span>cols<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/column.py</span> in <span class=\"ansicyan\">_to_java_column</span><span class=\"ansiblue\">(col)</span>\n<span class=\"ansigreen\">     46</span>         jcol <span class=\"ansiyellow\">=</span> col<span class=\"ansiyellow\">.</span>_jc<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span>     <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 48</span><span class=\"ansiyellow\">         </span>jcol <span class=\"ansiyellow\">=</span> _create_column_from_name<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     49</span>     <span class=\"ansigreen\">return</span> jcol<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     50</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/column.py</span> in <span class=\"ansicyan\">_create_column_from_name</span><span class=\"ansiblue\">(name)</span>\n<span class=\"ansigreen\">     39</span> <span class=\"ansigreen\">def</span> _create_column_from_name<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     40</span>     sc <span class=\"ansiyellow\">=</span> SparkContext<span class=\"ansiyellow\">.</span>_active_spark_context<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 41</span><span class=\"ansiyellow\">     </span><span class=\"ansigreen\">return</span> sc<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>functions<span class=\"ansiyellow\">.</span>col<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     42</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     43</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    802</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    803</span>         args_command = &quot;&quot;.join(\n<span class=\"ansigreen\">--&gt; 804</span><span class=\"ansiyellow\">             [get_command_part(arg, self.pool) for arg in new_args])\n</span><span class=\"ansigreen\">    805</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    806</span>         command <span class=\"ansiyellow\">=</span> proto<span class=\"ansiyellow\">.</span>CALL_COMMAND_NAME <span class=\"ansiyellow\">+</span><span class=\"ansired\">\\</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_command_part</span><span class=\"ansiblue\">(parameter, python_proxy_pool)</span>\n<span class=\"ansigreen\">    276</span>             command_part <span class=\"ansiyellow\">+=</span> <span class=\"ansiblue\">&quot;;&quot;</span> <span class=\"ansiyellow\">+</span> interface<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    277</span>     <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 278</span><span class=\"ansiyellow\">         </span>command_part <span class=\"ansiyellow\">=</span> REFERENCE_TYPE <span class=\"ansiyellow\">+</span> parameter<span class=\"ansiyellow\">.</span>_get_object_id<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    279</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    280</span>     command_part <span class=\"ansiyellow\">+=</span> <span class=\"ansiblue\">&quot;\\n&quot;</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;function&apos; object has no attribute &apos;_get_object_id&apos;\n</div>","workflows":[],"startTime":1.467681891212E12,"submitTime":1.467681878509E12,"finishTime":1.467681892528E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"abab600f-2615-4d7a-854f-66570fadccc7"},{"version":"CommandV1","origId":944615974881697,"guid":"dea18df9-88e6-4cc5-a458-55691638ede0","subtype":"command","commandType":"auto","position":7.0,"command":"%md\nTo understand why that failed, you have to understand how the attribute-column syntax is implemented.\n\nWhen you type `throwaway_df.count`, Python looks for an _existing_ attribute or method called `count` on the `throwaway_df` object. If it finds one, it uses it. Otherwise, it calls a special Python function (`__getattr__`), which defaults to throwing an exception. Spark has overridden `__getattr__` to look for a column on the DataFrame.\n\n**This means you can only use the attribute (dot) syntax to refer to a column if the DataFrame does not _already_ have an attribute with the column's name.**\n\nIn the above example, there's already a `count()` method on the `DataFrame` class, so `throwaway_df.count` does not refer to our \"count\" column; instead, it refers to the `count()` _method_.\n\nTo avoid this problem, you can refer to the column using subscript notation: `throwaway_df['count']`. This syntax will _always_ work.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878537E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8ce1d1d5-0c6b-4923-8b97-849965e546e2"},{"version":"CommandV1","origId":944615974881698,"guid":"5d5b3bcf-4ee9-4a11-ac64-71af8683eb63","subtype":"command","commandType":"auto","position":8.0,"command":"throwaway_df.select(throwaway_df['count']).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+\n|count|\n+-----+\n|   10|\n|   20|\n|    5|\n+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">Exception</span>: Cannot call display(&lt;type &apos;instancemethod&apos;&gt;)","error":"<div class=\"ansiout\">/databricks/python/local/lib/python2.7/site-packages/matplotlib/font_manager.py:273: UserWarning: Matplotlib is building the font cache using fc-list. This may take a moment.\n  warnings.warn(&apos;Matplotlib is building the font cache using fc-list. This may take a moment.&apos;)\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Exception</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-9-a47d6fcf0a1d&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>display<span class=\"ansiyellow\">(</span>throwaway_df<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/tmp/1467613600046-0/PythonShell.py</span> in <span class=\"ansicyan\">display</span><span class=\"ansiblue\">(self, input, *args, **kwargs)</span>\n<span class=\"ansigreen\">    454</span>             input<span class=\"ansiyellow\">.</span>help<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span> <span class=\"ansired\"># This is going to display the help as a side-effect</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    455</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 456</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">raise</span> Exception<span class=\"ansiyellow\">(</span>genericErrorMsg<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    457</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    458</span>     <span class=\"ansigreen\">def</span> displayHTML<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> html<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">Exception</span>: Cannot call display(&lt;type &apos;instancemethod&apos;&gt;)\n Call help(display) for more info.\n</div>","workflows":[],"startTime":1.467681892542E12,"submitTime":1.467681878562E12,"finishTime":1.467681893319E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e14a2292-7ca7-4b1d-8f1a-85cb13c7433d"},{"version":"CommandV1","origId":944615974881699,"guid":"1ba11044-507f-4e66-ac8a-96e2381c3c98","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n### (1a) Library Imports\n\n\nWe can import standard Python libraries ([modules](https://docs.python.org/2/tutorial/modules.html)) the usual way.  An `import` statement will import the specified module.  In this lab, we will provide any imports that are necessary.\n\nLet's import some of the libraries we'll need:\n\n* `re`: The regular expression library\n* `datetime`: Date and time functions\n* `Test`: Our Databricks test helper library","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878586E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9f570586-355c-4ac8-b276-9ab14154a169"},{"version":"CommandV1","origId":944615974881700,"guid":"9fb0a884-6a67-4818-88b1-1c116ae104fe","subtype":"command","commandType":"auto","position":10.0,"command":"import re\nimport datetime\nfrom databricks_test_helper import Test","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681893338E12,"submitTime":1.46768187861E12,"finishTime":1.467681895054E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c4437d4b-eb10-43ee-82dc-bc942b1d1090"},{"version":"CommandV1","origId":944615974881701,"guid":"725eb5c1-66c5-4102-a40e-bc8874451b7c","subtype":"command","commandType":"auto","position":11.0,"command":"# Quick test of the regular expression library\nm = re.search('(?<=abc)def', 'abcdef')\nm.group(0)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>&apos;def&apos;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681895061E12,"submitTime":1.467681878634E12,"finishTime":1.467681897581E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c983baec-be81-4f62-b3cb-5384ce4569b5"},{"version":"CommandV1","origId":944615974881702,"guid":"893682c5-89a2-4bb0-bb51-4ff4b01377d0","subtype":"command","commandType":"auto","position":12.0,"command":"# Quick test of the datetime library\nprint 'This was last run on: {0}'.format(datetime.datetime.now())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">This was last run on: 2016-07-05 01:24:57.630143\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681897589E12,"submitTime":1.467681878658E12,"finishTime":1.467681897662E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e0377ffe-c761-4284-af6f-ec55b29a07eb"},{"version":"CommandV1","origId":944615974881703,"guid":"bcd39795-cba6-4f5c-9781-a9be21fc8f42","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n### (1b) Getting help\n\nRemember: There are some useful Python built-ins for getting help.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878681E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"05a18f4d-50ad-4df8-97d7-5193cb95f119"},{"version":"CommandV1","origId":944615974881704,"guid":"b8ae4e7f-2f3f-467f-8031-159e3f45043a","subtype":"command","commandType":"auto","position":14.0,"command":"%md\nYou can use Python's [dir()](https://docs.python.org/2/library/functions.html?highlight=dir#dir) function to get a list of all the attributes (including methods) accessible through the `sqlContext` object.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878706E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7762090e-33f2-4b03-a941-bccca1fb317b"},{"version":"CommandV1","origId":944615974881705,"guid":"9ab774de-d61d-4611-8fae-da1dd7889c11","subtype":"command","commandType":"auto","position":15.0,"command":"# List sqlContext's attributes\ndir(sqlContext)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">7</span><span class=\"ansired\">]: </span>\n[&apos;__class__&apos;,\n &apos;__delattr__&apos;,\n &apos;__dict__&apos;,\n &apos;__doc__&apos;,\n &apos;__format__&apos;,\n &apos;__getattribute__&apos;,\n &apos;__hash__&apos;,\n &apos;__init__&apos;,\n &apos;__module__&apos;,\n &apos;__new__&apos;,\n &apos;__reduce__&apos;,\n &apos;__reduce_ex__&apos;,\n &apos;__repr__&apos;,\n &apos;__setattr__&apos;,\n &apos;__sizeof__&apos;,\n &apos;__str__&apos;,\n &apos;__subclasshook__&apos;,\n &apos;__weakref__&apos;,\n &apos;_createFromLocal&apos;,\n &apos;_createFromRDD&apos;,\n &apos;_get_hive_ctx&apos;,\n &apos;_inferSchema&apos;,\n &apos;_inferSchemaFromList&apos;,\n &apos;_instantiatedContext&apos;,\n &apos;_jsc&apos;,\n &apos;_jvm&apos;,\n &apos;_sc&apos;,\n &apos;_scala_HiveContext&apos;,\n &apos;_scala_SQLContext&apos;,\n &apos;_ssql_ctx&apos;,\n &apos;applySchema&apos;,\n &apos;cacheTable&apos;,\n &apos;clearCache&apos;,\n &apos;createDataFrame&apos;,\n &apos;createExternalTable&apos;,\n &apos;dropTempTable&apos;,\n &apos;getConf&apos;,\n &apos;getOrCreate&apos;,\n &apos;inferSchema&apos;,\n &apos;jsonFile&apos;,\n &apos;jsonRDD&apos;,\n &apos;load&apos;,\n &apos;newSession&apos;,\n &apos;parquetFile&apos;,\n &apos;range&apos;,\n &apos;read&apos;,\n &apos;refreshTable&apos;,\n &apos;registerDataFrameAsTable&apos;,\n &apos;registerFunction&apos;,\n &apos;setConf&apos;,\n &apos;sql&apos;,\n &apos;table&apos;,\n &apos;tableNames&apos;,\n &apos;tables&apos;,\n &apos;udf&apos;,\n &apos;uncacheTable&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681897672E12,"submitTime":1.46768187873E12,"finishTime":1.467681897712E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c40c021c-8de9-4672-88b3-316f4af9c0ed"},{"version":"CommandV1","origId":944615974881706,"guid":"ae7b8c64-b0fa-4ec5-b78b-a68b928dca2d","subtype":"command","commandType":"auto","position":16.0,"command":"%md\nAlternatively, you can use Python's [help()](https://docs.python.org/2/library/functions.html?highlight=help#help) function to get an easier to read list of all the attributes, including examples, that the `sqlContext` object has.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878754E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"96aa3522-a2f1-4c8d-8e97-94b55730caa8"},{"version":"CommandV1","origId":944615974881707,"guid":"b5a8a023-68dd-44e9-9cc0-77a6f13c8dce","subtype":"command","commandType":"auto","position":17.0,"command":"# Use help to obtain more detailed information\nhelp(sqlContext)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Help on HiveContext in module pyspark.sql.context object:\n\nclass HiveContext(SQLContext)\n |  A variant of Spark SQL that integrates with data stored in Hive.\n |  \n |  Configuration for Hive is read from &#96;&#96;hive-site.xml&#96;&#96; on the classpath.\n |  It supports running both SQL and HiveQL commands.\n |  \n |  :param sparkContext: The SparkContext to wrap.\n |  :param hiveContext: An optional JVM Scala HiveContext. If set, we do not instantiate a new\n |      :class:&#96;HiveContext&#96; in the JVM, instead we make all calls to this object.\n |  \n |  Method resolution order:\n |      HiveContext\n |      SQLContext\n |      __builtin__.object\n |  \n |  Methods defined here:\n |  \n |  __init__(self, sparkContext, hiveContext=None)\n |  \n |  refreshTable(self, tableName)\n |      Invalidate and refresh all the cached the metadata of the given\n |      table. For performance reasons, Spark SQL or the external data source\n |      library it uses might cache certain metadata about a table, such as the\n |      location of blocks. When those change outside of Spark SQL, users should\n |      call this function to invalidate the cache.\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from SQLContext:\n |  \n |  applySchema(self, rdd, schema)\n |      .. note:: Deprecated in 1.3, use :func:&#96;createDataFrame&#96; instead.\n |  \n |  cacheTable(self, tableName)\n |      Caches the specified table in-memory.\n |      \n |      .. versionadded:: 1.0\n |  \n |  clearCache(self)\n |      Removes all cached tables from the in-memory cache.\n |      \n |      .. versionadded:: 1.3\n |  \n |  createDataFrame(self, data, schema=None, samplingRatio=None)\n |      Creates a :class:&#96;DataFrame&#96; from an :class:&#96;RDD&#96; of :class:&#96;tuple&#96;/:class:&#96;list&#96;,\n |      list or :class:&#96;pandas.DataFrame&#96;.\n |      \n |      When &#96;&#96;schema&#96;&#96; is a list of column names, the type of each column\n |      will be inferred from &#96;&#96;data&#96;&#96;.\n |      \n |      When &#96;&#96;schema&#96;&#96; is &#96;&#96;None&#96;&#96;, it will try to infer the schema (column names and types)\n |      from &#96;&#96;data&#96;&#96;, which should be an RDD of :class:&#96;Row&#96;,\n |      or :class:&#96;namedtuple&#96;, or :class:&#96;dict&#96;.\n |      \n |      If schema inference is needed, &#96;&#96;samplingRatio&#96;&#96; is used to determined the ratio of\n |      rows used for schema inference. The first row will be used if &#96;&#96;samplingRatio&#96;&#96; is &#96;&#96;None&#96;&#96;.\n |      \n |      :param data: an RDD of :class:&#96;Row&#96;/:class:&#96;tuple&#96;/:class:&#96;list&#96;/:class:&#96;dict&#96;,\n |          :class:&#96;list&#96;, or :class:&#96;pandas.DataFrame&#96;.\n |      :param schema: a :class:&#96;StructType&#96; or list of column names. default None.\n |      :param samplingRatio: the sample ratio of rows used for inferring\n |      :return: :class:&#96;DataFrame&#96;\n |      \n |      &gt;&gt;&gt; l = [(&apos;Alice&apos;, 1)]\n |      &gt;&gt;&gt; sqlContext.createDataFrame(l).collect()\n |      [Row(_1=u&apos;Alice&apos;, _2=1)]\n |      &gt;&gt;&gt; sqlContext.createDataFrame(l, [&apos;name&apos;, &apos;age&apos;]).collect()\n |      [Row(name=u&apos;Alice&apos;, age=1)]\n |      \n |      &gt;&gt;&gt; d = [{&apos;name&apos;: &apos;Alice&apos;, &apos;age&apos;: 1}]\n |      &gt;&gt;&gt; sqlContext.createDataFrame(d).collect()\n |      [Row(age=1, name=u&apos;Alice&apos;)]\n |      \n |      &gt;&gt;&gt; rdd = sc.parallelize(l)\n |      &gt;&gt;&gt; sqlContext.createDataFrame(rdd).collect()\n |      [Row(_1=u&apos;Alice&apos;, _2=1)]\n |      &gt;&gt;&gt; df = sqlContext.createDataFrame(rdd, [&apos;name&apos;, &apos;age&apos;])\n |      &gt;&gt;&gt; df.collect()\n |      [Row(name=u&apos;Alice&apos;, age=1)]\n |      \n |      &gt;&gt;&gt; from pyspark.sql import Row\n |      &gt;&gt;&gt; Person = Row(&apos;name&apos;, &apos;age&apos;)\n |      &gt;&gt;&gt; person = rdd.map(lambda r: Person(*r))\n |      &gt;&gt;&gt; df2 = sqlContext.createDataFrame(person)\n |      &gt;&gt;&gt; df2.collect()\n |      [Row(name=u&apos;Alice&apos;, age=1)]\n |      \n |      &gt;&gt;&gt; from pyspark.sql.types import *\n |      &gt;&gt;&gt; schema = StructType([\n |      ...    StructField(&quot;name&quot;, StringType(), True),\n |      ...    StructField(&quot;age&quot;, IntegerType(), True)])\n |      &gt;&gt;&gt; df3 = sqlContext.createDataFrame(rdd, schema)\n |      &gt;&gt;&gt; df3.collect()\n |      [Row(name=u&apos;Alice&apos;, age=1)]\n |      \n |      &gt;&gt;&gt; sqlContext.createDataFrame(df.toPandas()).collect()  # doctest: +SKIP\n |      [Row(name=u&apos;Alice&apos;, age=1)]\n |      &gt;&gt;&gt; sqlContext.createDataFrame(pandas.DataFrame([[1, 2]])).collect()  # doctest: +SKIP\n |      [Row(0=1, 1=2)]\n |      \n |      .. versionadded:: 1.3\n |  \n |  createExternalTable(self, tableName, path=None, source=None, schema=None, **options)\n |      Creates an external table based on the dataset in a data source.\n |      \n |      It returns the DataFrame associated with the external table.\n |      \n |      The data source is specified by the &#96;&#96;source&#96;&#96; and a set of &#96;&#96;options&#96;&#96;.\n |      If &#96;&#96;source&#96;&#96; is not specified, the default data source configured by\n |      &#96;&#96;spark.sql.sources.default&#96;&#96; will be used.\n |      \n |      Optionally, a schema can be provided as the schema of the returned :class:&#96;DataFrame&#96; and\n |      created external table.\n |      \n |      :return: :class:&#96;DataFrame&#96;\n |      \n |      .. versionadded:: 1.3\n |  \n |  dropTempTable(self, tableName)\n |      Remove the temp table from catalog.\n |      \n |      &gt;&gt;&gt; sqlContext.registerDataFrameAsTable(df, &quot;table1&quot;)\n |      &gt;&gt;&gt; sqlContext.dropTempTable(&quot;table1&quot;)\n |      \n |      .. versionadded:: 1.6\n |  \n |  getConf(self, key, defaultValue)\n |      Returns the value of Spark SQL configuration property for the given key.\n |      \n |      If the key is not set, returns defaultValue.\n |      \n |      .. versionadded:: 1.3\n |  \n |  inferSchema(self, rdd, samplingRatio=None)\n |      .. note:: Deprecated in 1.3, use :func:&#96;createDataFrame&#96; instead.\n |  \n |  jsonFile(self, path, schema=None, samplingRatio=1.0)\n |      Loads a text file storing one JSON object per line as a :class:&#96;DataFrame&#96;.\n |      \n |      .. note:: Deprecated in 1.4, use :func:&#96;DataFrameReader.json&#96; instead.\n |      \n |      &gt;&gt;&gt; sqlContext.jsonFile(&apos;python/test_support/sql/people.json&apos;).dtypes\n |      [(&apos;age&apos;, &apos;bigint&apos;), (&apos;name&apos;, &apos;string&apos;)]\n |  \n |  jsonRDD(self, rdd, schema=None, samplingRatio=1.0)\n |      Loads an RDD storing one JSON object per string as a :class:&#96;DataFrame&#96;.\n |      \n |      If the schema is provided, applies the given schema to this JSON dataset.\n |      Otherwise, it samples the dataset with ratio &#96;&#96;samplingRatio&#96;&#96; to determine the schema.\n |      \n |      &gt;&gt;&gt; df1 = sqlContext.jsonRDD(json)\n |      &gt;&gt;&gt; df1.first()\n |      Row(field1=1, field2=u&apos;row1&apos;, field3=Row(field4=11, field5=None), field6=None)\n |      \n |      &gt;&gt;&gt; df2 = sqlContext.jsonRDD(json, df1.schema)\n |      &gt;&gt;&gt; df2.first()\n |      Row(field1=1, field2=u&apos;row1&apos;, field3=Row(field4=11, field5=None), field6=None)\n |      \n |      &gt;&gt;&gt; from pyspark.sql.types import *\n |      &gt;&gt;&gt; schema = StructType([\n |      ...     StructField(&quot;field2&quot;, StringType()),\n |      ...     StructField(&quot;field3&quot;,\n |      ...                 StructType([StructField(&quot;field5&quot;, ArrayType(IntegerType()))]))\n |      ... ])\n |      &gt;&gt;&gt; df3 = sqlContext.jsonRDD(json, schema)\n |      &gt;&gt;&gt; df3.first()\n |      Row(field2=u&apos;row1&apos;, field3=Row(field5=None))\n |      \n |      .. versionadded:: 1.0\n |  \n |  load(self, path=None, source=None, schema=None, **options)\n |      Returns the dataset in a data source as a :class:&#96;DataFrame&#96;.\n |      \n |      .. note:: Deprecated in 1.4, use :func:&#96;DataFrameReader.load&#96; instead.\n |  \n |  newSession(self)\n |      Returns a new SQLContext as new session, that has separate SQLConf,\n |      registered temporary tables and UDFs, but shared SparkContext and\n |      table cache.\n |      \n |      .. versionadded:: 1.6\n |  \n |  parquetFile(self, *paths)\n |      Loads a Parquet file, returning the result as a :class:&#96;DataFrame&#96;.\n |      \n |      .. note:: Deprecated in 1.4, use :func:&#96;DataFrameReader.parquet&#96; instead.\n |      \n |      &gt;&gt;&gt; sqlContext.parquetFile(&apos;python/test_support/sql/parquet_partitioned&apos;).dtypes\n |      [(&apos;name&apos;, &apos;string&apos;), (&apos;year&apos;, &apos;int&apos;), (&apos;month&apos;, &apos;int&apos;), (&apos;day&apos;, &apos;int&apos;)]\n |  \n |  range(self, start, end=None, step=1, numPartitions=None)\n |      Create a :class:&#96;DataFrame&#96; with single LongType column named &#96;id&#96;,\n |      containing elements in a range from &#96;start&#96; to &#96;end&#96; (exclusive) with\n |      step value &#96;step&#96;.\n |      \n |      :param start: the start value\n |      :param end: the end value (exclusive)\n |      :param step: the incremental step (default: 1)\n |      :param numPartitions: the number of partitions of the DataFrame\n |      :return: :class:&#96;DataFrame&#96;\n |      \n |      &gt;&gt;&gt; sqlContext.range(1, 7, 2).collect()\n |      [Row(id=1), Row(id=3), Row(id=5)]\n |      \n |      If only one argument is specified, it will be used as the end value.\n |      \n |      &gt;&gt;&gt; sqlContext.range(3).collect()\n |      [Row(id=0), Row(id=1), Row(id=2)]\n |      \n |      .. versionadded:: 1.4\n |  \n |  registerDataFrameAsTable(self, df, tableName)\n |      Registers the given :class:&#96;DataFrame&#96; as a temporary table in the catalog.\n |      \n |      Temporary tables exist only during the lifetime of this instance of :class:&#96;SQLContext&#96;.\n |      \n |      &gt;&gt;&gt; sqlContext.registerDataFrameAsTable(df, &quot;table1&quot;)\n |      \n |      .. versionadded:: 1.3\n |  \n |  registerFunction(self, name, f, returnType=StringType)\n |      Registers a python function (including lambda function) as a UDF\n |      so it can be used in SQL statements.\n |      \n |      In addition to a name and the function itself, the return type can be optionally specified.\n |      When the return type is not given it default to a string and conversion will automatically\n |      be done.  For any other return type, the produced object must match the specified type.\n |      \n |      :param name: name of the UDF\n |      :param f: python function\n |      :param returnType: a :class:&#96;DataType&#96; object\n |      \n |      &gt;&gt;&gt; sqlContext.registerFunction(&quot;stringLengthString&quot;, lambda x: len(x))\n |      &gt;&gt;&gt; sqlContext.sql(&quot;SELECT stringLengthString(&apos;test&apos;)&quot;).collect()\n |      [Row(_c0=u&apos;4&apos;)]\n |      \n |      &gt;&gt;&gt; from pyspark.sql.types import IntegerType\n |      &gt;&gt;&gt; sqlContext.registerFunction(&quot;stringLengthInt&quot;, lambda x: len(x), IntegerType())\n |      &gt;&gt;&gt; sqlContext.sql(&quot;SELECT stringLengthInt(&apos;test&apos;)&quot;).collect()\n |      [Row(_c0=4)]\n |      \n |      &gt;&gt;&gt; from pyspark.sql.types import IntegerType\n |      &gt;&gt;&gt; sqlContext.udf.register(&quot;stringLengthInt&quot;, lambda x: len(x), IntegerType())\n |      &gt;&gt;&gt; sqlContext.sql(&quot;SELECT stringLengthInt(&apos;test&apos;)&quot;).collect()\n |      [Row(_c0=4)]\n |      \n |      .. versionadded:: 1.2\n |  \n |  setConf(self, key, value)\n |      Sets the given Spark SQL configuration property.\n |      \n |      .. versionadded:: 1.3\n |  \n |  sql(self, sqlQuery)\n |      Returns a :class:&#96;DataFrame&#96; representing the result of the given query.\n |      \n |      :return: :class:&#96;DataFrame&#96;\n |      \n |      &gt;&gt;&gt; sqlContext.registerDataFrameAsTable(df, &quot;table1&quot;)\n |      &gt;&gt;&gt; df2 = sqlContext.sql(&quot;SELECT field1 AS f1, field2 as f2 from table1&quot;)\n |      &gt;&gt;&gt; df2.collect()\n |      [Row(f1=1, f2=u&apos;row1&apos;), Row(f1=2, f2=u&apos;row2&apos;), Row(f1=3, f2=u&apos;row3&apos;)]\n |      \n |      .. versionadded:: 1.0\n |  \n |  table(self, tableName)\n |      Returns the specified table as a :class:&#96;DataFrame&#96;.\n |      \n |      :return: :class:&#96;DataFrame&#96;\n |      \n |      &gt;&gt;&gt; sqlContext.registerDataFrameAsTable(df, &quot;table1&quot;)\n |      &gt;&gt;&gt; df2 = sqlContext.table(&quot;table1&quot;)\n |      &gt;&gt;&gt; sorted(df.collect()) == sorted(df2.collect())\n |      True\n |      \n |      .. versionadded:: 1.0\n |  \n |  tableNames(self, dbName=None)\n |      Returns a list of names of tables in the database &#96;&#96;dbName&#96;&#96;.\n |      \n |      :param dbName: string, name of the database to use. Default to the current database.\n |      :return: list of table names, in string\n |      \n |      &gt;&gt;&gt; sqlContext.registerDataFrameAsTable(df, &quot;table1&quot;)\n |      &gt;&gt;&gt; &quot;table1&quot; in sqlContext.tableNames()\n |      True\n |      &gt;&gt;&gt; &quot;table1&quot; in sqlContext.tableNames(&quot;db&quot;)\n |      True\n |      \n |      .. versionadded:: 1.3\n |  \n |  tables(self, dbName=None)\n |      Returns a :class:&#96;DataFrame&#96; containing names of tables in the given database.\n |      \n |      If &#96;&#96;dbName&#96;&#96; is not specified, the current database will be used.\n |      \n |      The returned DataFrame has two columns: &#96;&#96;tableName&#96;&#96; and &#96;&#96;isTemporary&#96;&#96;\n |      (a column with :class:&#96;BooleanType&#96; indicating if a table is a temporary one or not).\n |      \n |      :param dbName: string, name of the database to use.\n |      :return: :class:&#96;DataFrame&#96;\n |      \n |      &gt;&gt;&gt; sqlContext.registerDataFrameAsTable(df, &quot;table1&quot;)\n |      &gt;&gt;&gt; df2 = sqlContext.tables()\n |      &gt;&gt;&gt; df2.filter(&quot;tableName = &apos;table1&apos;&quot;).first()\n |      Row(tableName=u&apos;table1&apos;, isTemporary=True)\n |      \n |      .. versionadded:: 1.3\n |  \n |  uncacheTable(self, tableName)\n |      Removes the specified table from the in-memory cache.\n |      \n |      .. versionadded:: 1.0\n |  \n |  ----------------------------------------------------------------------\n |  Class methods inherited from SQLContext:\n |  \n |  getOrCreate(cls, sc) from __builtin__.type\n |      Get the existing SQLContext or create a new one with given SparkContext.\n |      \n |      :param sc: SparkContext\n |      \n |      .. versionadded:: 1.6\n |  \n |  ----------------------------------------------------------------------\n |  Data descriptors inherited from SQLContext:\n |  \n |  __dict__\n |      dictionary for instance variables (if defined)\n |  \n |  __weakref__\n |      list of weak references to the object (if defined)\n |  \n |  read\n |      Returns a :class:&#96;DataFrameReader&#96; that can be used to read data\n |      in as a :class:&#96;DataFrame&#96;.\n |      \n |      :return: :class:&#96;DataFrameReader&#96;\n |      \n |      .. versionadded:: 1.4\n |  \n |  udf\n |      Returns a :class:&#96;UDFRegistration&#96; for UDF registration.\n |      \n |      :return: :class:&#96;UDFRegistration&#96;\n |      \n |      .. versionadded:: 1.3.1\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681897722E12,"submitTime":1.467681878777E12,"finishTime":1.467681897749E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4994eb36-f486-4ecd-9472-abfa03d852cc"},{"version":"CommandV1","origId":944615974881708,"guid":"5bcf2082-94a4-458b-b873-7a54b817527d","subtype":"command","commandType":"auto","position":18.0,"command":"# Help can be used on any Python object\nhelp(map)\nhelp(Test)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Help on built-in function map in module __builtin__:\n\nmap(...)\n    map(function, sequence[, sequence, ...]) -&gt; list\n    \n    Return a list of the results of applying the function to the items of\n    the argument sequence(s).  If more than one sequence is given, the\n    function is called with an argument list consisting of the corresponding\n    item of each sequence, substituting None for missing values when not all\n    sequences have the same length.  If the function is None, return a list of\n    the items of the sequence (or a list of tuples if more than one sequence).\n\nHelp on class Test in module databricks_test_helper.databricks_test_helper:\n\nclass Test(__builtin__.object)\n |  Class methods defined here:\n |  \n |  assertEquals(cls, var, val, msg=&apos;&apos;) from __builtin__.type\n |  \n |  assertEqualsHashed(cls, var, hashed_val, msg=&apos;&apos;) from __builtin__.type\n |  \n |  assertTrue(cls, result, msg=&apos;&apos;) from __builtin__.type\n |  \n |  printStats(cls) from __builtin__.type\n |  \n |  setFailFast(cls) from __builtin__.type\n |  \n |  setPrivateMode(cls) from __builtin__.type\n |  \n |  ----------------------------------------------------------------------\n |  Data descriptors defined here:\n |  \n |  __dict__\n |      dictionary for instance variables (if defined)\n |  \n |  __weakref__\n |      list of weak references to the object (if defined)\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes defined here:\n |  \n |  failFast = False\n |  \n |  numTests = 0\n |  \n |  passed = 0\n |  \n |  private = False\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;Test&apos; is not defined","error":"<div class=\"ansiout\">Help on built-in function map in module __builtin__:\n\nmap(...)\n    map(function, sequence[, sequence, ...]) -&gt; list\n    \n    Return a list of the results of applying the function to the items of\n    the argument sequence(s).  If more than one sequence is given, the\n    function is called with an argument list consisting of the corresponding\n    item of each sequence, substituting None for missing values when not all\n    sequences have the same length.  If the function is None, return a list of\n    the items of the sequence (or a list of tuples if more than one sequence).\n\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-4-996cade35f58&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># Help can be used on any Python object</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> help<span class=\"ansiyellow\">(</span>map<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>help<span class=\"ansiyellow\">(</span>Test<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;Test&apos; is not defined\n</div>","workflows":[],"startTime":1.46768189776E12,"submitTime":1.467681878802E12,"finishTime":1.467681897785E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"304f2114-c4fa-40c6-8cfb-a804f4a2abac"},{"version":"CommandV1","origId":944615974881709,"guid":"066740f1-104d-4ce8-8c82-cc20da288b8c","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n## Part 2: Exploratory Data Analysis\n\nLet's begin looking at our data.  For this lab, we will use a data set from NASA Kennedy Space Center web server in Florida. The full data set is freely available at <http://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html>, and it contains all HTTP requests for two months. We are using a subset that only contains several days' worth of requests.  The log file has already been downloaded for you.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878827E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"52c72475-f2f3-4564-9579-0575bccc53b8"},{"version":"CommandV1","origId":944615974881710,"guid":"771244f5-cea6-421d-8300-3dac46669ec5","subtype":"command","commandType":"auto","position":20.0,"command":"# Specify path to downloaded log file\nimport sys\nimport os\n\nlog_file_path = 'dbfs:/' + os.path.join('databricks-datasets', 'cs100', 'lab2', 'data-001', 'apache.access.log.PROJECT')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681897793E12,"submitTime":1.467681878856E12,"finishTime":1.467681897834E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4ee39779-d8fc-43f6-bb31-80ce3b77a263"},{"version":"CommandV1","origId":944615974881711,"guid":"8c48c328-184c-4383-874c-152c043f262e","subtype":"command","commandType":"auto","position":21.0,"command":"%md\n### (2a) Loading the log file\n\nNow that we have the path to the file, let's load it into a DataFrame. We'll do this in steps. First, we'll use `sqlContext.read.text()` to read the text file. This will produce a DataFrame with a single string column called `value`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878878E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a60a572e-c9f5-45af-8a65-390454149558"},{"version":"CommandV1","origId":944615974881712,"guid":"edd5d437-73bf-4d64-a107-7a469cb3ade1","subtype":"command","commandType":"auto","position":22.0,"command":"base_df = sqlContext.read.text(log_file_path)\n# Let's look at the schema\nbase_df.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- value: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;log_file_path&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-9-b5a27a790618&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>base_df <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>text<span class=\"ansiyellow\">(</span>log_file_path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansired\"># Let&apos;s look at the schema</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> base_df<span class=\"ansiyellow\">.</span>printSchema<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;log_file_path&apos; is not defined\n</div>","workflows":[],"startTime":1.467681897842E12,"submitTime":1.467681878902E12,"finishTime":1.467681898115E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e46e8d9b-cd47-4a4a-960e-57ed8ab91753"},{"version":"CommandV1","origId":944615974881713,"guid":"4bb04e60-d7d0-4cc6-9374-75c117429c34","subtype":"command","commandType":"auto","position":23.0,"command":"%md\nLet's take a look at some of the data.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878924E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"38b8deca-3877-480c-853a-9974d30a0dd7"},{"version":"CommandV1","origId":944615974881714,"guid":"55d20e87-0a68-4c2f-99d7-f6da40e73b2e","subtype":"command","commandType":"auto","position":24.0,"command":"base_df.show(10, truncate =False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------------------------------------------------------------------------------------------------------------+\n|value                                                                                                                     |\n+--------------------------------------------------------------------------------------------------------------------------+\n|in24.inetnebr.com - - [01/Aug/1995:00:00:01 -0400] &quot;GET /shuttle/missions/sts-68/news/sts-68-mcc-05.txt HTTP/1.0&quot; 200 1839|\n|uplherc.upl.com - - [01/Aug/1995:00:00:07 -0400] &quot;GET / HTTP/1.0&quot; 304 0                                                   |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] &quot;GET /images/ksclogo-medium.gif HTTP/1.0&quot; 304 0                          |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] &quot;GET /images/MOSAIC-logosmall.gif HTTP/1.0&quot; 304 0                        |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] &quot;GET /images/USA-logosmall.gif HTTP/1.0&quot; 304 0                           |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:09 -0400] &quot;GET /images/launch-logo.gif HTTP/1.0&quot; 200 1713              |\n|uplherc.upl.com - - [01/Aug/1995:00:00:10 -0400] &quot;GET /images/WORLD-logosmall.gif HTTP/1.0&quot; 304 0                         |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:10 -0400] &quot;GET /history/skylab/skylab.html HTTP/1.0&quot; 200 1687                 |\n|piweba4y.prodigy.com - - [01/Aug/1995:00:00:10 -0400] &quot;GET /images/launchmedium.gif HTTP/1.0&quot; 200 11853                   |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:11 -0400] &quot;GET /history/skylab/skylab-small.gif HTTP/1.0&quot; 200 9202            |\n+--------------------------------------------------------------------------------------------------------------------------+\nonly showing top 10 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-30-d0e0027d8f0e&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    base_df[][]</span>\n<span class=\"ansigrey\">            ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","workflows":[],"startTime":1.467681898123E12,"submitTime":1.467681878946E12,"finishTime":1.467681898549E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d0c7d09f-5c4b-41e5-adf0-7267e3ff42c2"},{"version":"CommandV1","origId":944615974881715,"guid":"7ac5aa8e-7014-4a0f-a5c1-8ca7a4649f20","subtype":"command","commandType":"auto","position":25.0,"command":"%md\n### (2b) Parsing the log file","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46768187897E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8eb69e1a-6575-4136-9ad0-ac9d8ae8fed0"},{"version":"CommandV1","origId":944615974881716,"guid":"279033bc-0d55-4270-91be-17042db81422","subtype":"command","commandType":"auto","position":26.0,"command":"%md\nIf you're familiar with web servers at all, you'll recognize that this is in [Common Log Format](https://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format). The fields are:\n\n_remotehost rfc931 authuser [date] \"request\" status bytes_\n\n| field         | meaning                                                                |\n| ------------- | ---------------------------------------------------------------------- |\n| _remotehost_  | Remote hostname (or IP number if DNS hostname is not available).       |\n| _rfc931_      | The remote logname of the user. We don't really care about this field. |\n| _authuser_    | The username of the remote user, as authenticated by the HTTP server.  |\n| _[date]_      | The date and time of the request.                                      |\n| _\"request\"_   | The request, exactly as it came from the browser or client.            |\n| _status_      | The HTTP status code the server sent back to the client.               |\n| _bytes_       | The number of bytes (`Content-Length`) transferred to the client.      |\n\n\nNext, we have to parse it into individual columns. We'll use the special built-in [regexp\\_extract()](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.regexp_extract)\nfunction to do the parsing. This function matches a column against a regular expression with one or more [capture groups](http://regexone.com/lesson/capturing_groups) and allows you to extract one of the matched groups. We'll use one regular expression for each field we wish to extract.\n\nIf you can't read these regular expressions, don't worry. Trust us: They work. If you find regular expressions confusing (and they certainly _can_ be), and you want to learn more about them, start with the\n[RegexOne web site](http://regexone.com/). You might also find [_Regular Expressions Cookbook_](http://shop.oreilly.com/product/0636920023630.do), by Jan Goyvaerts and Steven Levithan, to be helpful.\n\n_Some people, when confronted with a problem, think \"I know, I'll use regular expressions.\" Now they have two problems._ (attributed to Jamie Zawinski)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681878993E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"83f68017-fc8c-4520-8de9-cc99162c3dec"},{"version":"CommandV1","origId":944615974881717,"guid":"01bf3772-90c3-422c-bfd1-6528434f337c","subtype":"command","commandType":"auto","position":27.0,"command":"from pyspark.sql.functions import split, regexp_extract\nsplit_df = base_df.select(regexp_extract('value', r'^([^\\s]+\\s)', 1).alias('host'),\n                          regexp_extract('value', r'^.*\\[(\\d\\d/\\w{3}/\\d{4}:\\d{2}:\\d{2}:\\d{2} -\\d{4})]', 1).alias('timestamp'),\n                          regexp_extract('value', r'^.*\"\\w+\\s+([^\\s]+)\\s+HTTP.*\"', 1).alias('path'),\n                          regexp_extract('value', r'^.*\"\\s+([^\\s]+)', 1).cast('integer').alias('status'),\n                          regexp_extract('value', r'^.*\\s+(\\d+)$', 1).cast('integer').alias('content_size'))\nsplit_df.show(truncate=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------------------------+--------------------------+---------------------------------------------------+------+------------+\n|host                        |timestamp                 |path                                               |status|content_size|\n+----------------------------+--------------------------+---------------------------------------------------+------+------------+\n|in24.inetnebr.com           |01/Aug/1995:00:00:01 -0400|/shuttle/missions/sts-68/news/sts-68-mcc-05.txt    |200   |1839        |\n|uplherc.upl.com             |01/Aug/1995:00:00:07 -0400|/                                                  |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/ksclogo-medium.gif                         |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/MOSAIC-logosmall.gif                       |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/USA-logosmall.gif                          |304   |0           |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:09 -0400|/images/launch-logo.gif                            |200   |1713        |\n|uplherc.upl.com             |01/Aug/1995:00:00:10 -0400|/images/WORLD-logosmall.gif                        |304   |0           |\n|slppp6.intermind.net        |01/Aug/1995:00:00:10 -0400|/history/skylab/skylab.html                        |200   |1687        |\n|piweba4y.prodigy.com        |01/Aug/1995:00:00:10 -0400|/images/launchmedium.gif                           |200   |11853       |\n|slppp6.intermind.net        |01/Aug/1995:00:00:11 -0400|/history/skylab/skylab-small.gif                   |200   |9202        |\n|slppp6.intermind.net        |01/Aug/1995:00:00:12 -0400|/images/ksclogosmall.gif                           |200   |3635        |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:12 -0400|/history/apollo/images/apollo-logo1.gif            |200   |1173        |\n|slppp6.intermind.net        |01/Aug/1995:00:00:13 -0400|/history/apollo/images/apollo-logo.gif             |200   |3047        |\n|uplherc.upl.com             |01/Aug/1995:00:00:14 -0400|/images/NASA-logosmall.gif                         |304   |0           |\n|133.43.96.45                |01/Aug/1995:00:00:16 -0400|/shuttle/missions/sts-69/mission-sts-69.html       |200   |10566       |\n|kgtyk4.kj.yamagata-u.ac.jp  |01/Aug/1995:00:00:17 -0400|/                                                  |200   |7280        |\n|kgtyk4.kj.yamagata-u.ac.jp  |01/Aug/1995:00:00:18 -0400|/images/ksclogo-medium.gif                         |200   |5866        |\n|d0ucr6.fnal.gov             |01/Aug/1995:00:00:19 -0400|/history/apollo/apollo-16/apollo-16.html           |200   |2743        |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:19 -0400|/shuttle/resources/orbiters/discovery.html         |200   |6849        |\n|d0ucr6.fnal.gov             |01/Aug/1995:00:00:20 -0400|/history/apollo/apollo-16/apollo-16-patch-small.gif|200   |14897       |\n+----------------------------+--------------------------+---------------------------------------------------+------+------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681898557E12,"submitTime":1.467681879016E12,"finishTime":1.467681899142E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"06862c29-3660-465c-8e7c-621056016814"},{"version":"CommandV1","origId":944615974881718,"guid":"4c3ad7db-2b3c-4a8b-9593-d9c2486b1695","subtype":"command","commandType":"auto","position":28.0,"command":"%md\n### (2c) Data Cleaning\n\nLet's see how well our parsing logic worked. First, let's verify that there are no null rows in the original data set.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879041E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0baaec56-f090-4308-b9b2-5a9ee91f7eaf"},{"version":"CommandV1","origId":944615974881719,"guid":"3f1b5301-b13b-4f44-a76b-1e9e2502ee2e","subtype":"command","commandType":"auto","position":29.0,"command":"base_df.filter(base_df['value'].isNull()).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;base_df&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-1-eb0c29a941c2&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>base_df<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>base_df<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;value&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>isNull<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;base_df&apos; is not defined\n</div>","workflows":[],"startTime":1.467681899152E12,"submitTime":1.467681879063E12,"finishTime":1.467681900669E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"59e7d928-6bdf-440d-8dbc-2a9051b3f009"},{"version":"CommandV1","origId":944615974881720,"guid":"c5d7ff6b-b643-424b-978d-6bfb89e6b2ba","subtype":"command","commandType":"auto","position":30.0,"command":"%md\nIf our parsing worked properly, we'll have no rows with null column values. Let's check.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879086E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"82567ffa-9aee-4dc4-ae13-a51d6df11199"},{"version":"CommandV1","origId":944615974881721,"guid":"9f9e44c8-7cf9-46d3-8e06-0d78fec06632","subtype":"command","commandType":"auto","position":31.0,"command":"bad_rows_df = split_df.filter(split_df['host'].isNull() |\n                              split_df['timestamp'].isNull() |\n                              split_df['path'].isNull() |\n                              split_df['status'].isNull() |\n                             split_df['content_size'].isNull())\nbad_rows_df.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>8756\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.467681900679E12,"submitTime":1.467681879109E12,"finishTime":1.467681909355E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a3efc943-da5d-4162-945d-effde5d77109"},{"version":"CommandV1","origId":944615974881722,"guid":"eeff1869-f48d-4c1c-a813-1c007338ee69","subtype":"command","commandType":"auto","position":32.0,"command":"%md\nNot good. We have some null values. Something went wrong. Which columns are affected?\n\n(Note: This approach is adapted from an [excellent answer](http://stackoverflow.com/a/33901312) on StackOverflow.)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879132E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8c7fb46a-ba3d-4be9-a223-379aa3570fb9"},{"version":"CommandV1","origId":2122214028309789,"guid":"6419c597-9969-4c9a-8cf4-507ea3537a40","subtype":"command","commandType":"auto","position":32.5,"command":"col(host)","commandVersion":0,"state":"error","results":null,"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;col&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-16-1948d5cc4e40&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>col<span class=\"ansiyellow\">(</span>host<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;col&apos; is not defined\n</div>","workflows":[],"startTime":1.467681879154E12,"submitTime":1.467681879154E12,"finishTime":1.467681905815E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"077dcb7a-30a7-490f-8537-8716df2569a4"},{"version":"CommandV1","origId":944615974881723,"guid":"fdbe1a2c-f1dd-4e7b-a2d2-146d472f5d05","subtype":"command","commandType":"auto","position":33.0,"command":"from pyspark.sql.functions import col, sum\n\ndef count_null(col_name):\n  return sum(col(col_name).isNull().cast('integer')).alias(col_name)\n\n# Build up a list of column expressions, one per column\nexprs = []\nfor col_name in split_df.columns:\n  exprs.append(count_null(col_name))\n\n# Run the aggregation. The *exprs converts the list of expressions into\n# variable function arguments.\nsplit_df.agg(*exprs).show()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879177E12,"submitTime":1.467681879177E12,"finishTime":1.467681905816E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5fa848bf-35b8-4c2a-9470-f9543ea15b13"},{"version":"CommandV1","origId":944615974881724,"guid":"9f040efc-453e-4d6a-8492-57c4b997f677","subtype":"command","commandType":"auto","position":34.0,"command":"%md\nOkay, they're all in the `content_size` column. Let's see if we can figure out what's wrong. Our original parsing regular expression for that column was:\n\n```\nregexp_extract('value', r'^.*\\s+(\\d+)$', 1).cast('integer').alias('content_size')\n```\n\nThe `\\d+` selects one or more digits at the end of the input line. Is it possible there are lines without a valid content size? Or is there something wrong with our regular expression? Let's see if there are any lines that do not end with one or more digits.\n\n**Note**: In the expression below, `~` means \"not\".","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.4676818792E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e7a20b59-d99a-44dd-be5e-a8eb0e31dafc"},{"version":"CommandV1","origId":944615974881725,"guid":"7567e533-954c-4ea3-9627-0203f19fec1b","subtype":"command","commandType":"auto","position":35.0,"command":"bad_content_size_df = base_df.filter(~ base_df['value'].rlike(r'\\d+$'))\nbad_content_size_df.count()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879222E12,"submitTime":1.467681879222E12,"finishTime":1.467681905817E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5f96f9a5-5a96-4729-b87e-a66cd521f974"},{"version":"CommandV1","origId":944615974881726,"guid":"0447408c-ddca-4e0d-adcc-00136cdfd76e","subtype":"command","commandType":"auto","position":36.0,"command":"%md\nThat's it! The count matches the number of rows in `bad_rows_df` exactly.\n\nLet's take a look at some of the bad column values. Since it's possible that the rows end in extra white space, we'll tack a marker character onto the end of each line, to make it easier to see trailing white space.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879245E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c6745f0e-e379-4305-b846-94edd7c847bc"},{"version":"CommandV1","origId":944615974881727,"guid":"ca65cfd7-9b18-48b3-b9f0-aeb65c88b955","subtype":"command","commandType":"auto","position":37.0,"command":"from pyspark.sql.functions import lit, concat\nbad_content_size_df.select(concat(bad_content_size_df['value'], lit('*'))).show(truncate=False)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879267E12,"submitTime":1.467681879267E12,"finishTime":1.467681905817E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8e72a5c0-6fd0-46fb-9bdc-5c633055e927"},{"version":"CommandV1","origId":944615974881728,"guid":"0d30cce4-bcba-4bcf-9016-ac42c5dda0f6","subtype":"command","commandType":"auto","position":38.0,"command":"%md\nAh. The bad rows correspond to error results, where no content was sent back and the server emitted a \"`-`\" for the `content_size` field. Since we don't want to discard those rows from our analysis, let's map them to 0.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879291E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"635e8a65-e4f4-494b-9917-209aa596275e"},{"version":"CommandV1","origId":944615974881729,"guid":"25a8c8e7-438f-4392-921f-25d70707fab3","subtype":"command","commandType":"auto","position":39.0,"command":"%md\n### (2d) Fix the rows with null content\\_size\n\nThe easiest solution is to replace the null values in `split_df` with 0. The DataFrame API provides a set of functions and fields specifically designed for working with null values, among them:\n\n* [fillna()](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.fillna), which fills null values with specified non-null values.\n* [na](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.na), which returns a [DataFrameNaFunctions](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrameNaFunctions) object with many functions for operating on null columns.\n\nWe'll use `fillna()`, because it's simple. There are several ways to invoke this function. The easiest is just to replace _all_ null columns with known values. But, for safety, it's better to pass a Python dictionary containing (column\\_name, value) mappings. That's what we'll do.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879315E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"afbd52c1-562a-48c6-ac9a-c063be3c5bc7"},{"version":"CommandV1","origId":944615974881730,"guid":"11559d8b-efc9-4468-a811-8e37850a97bf","subtype":"command","commandType":"auto","position":40.0,"command":"# Replace all null content_size values with 0.\ncleaned_df = split_df.fillna({'content_size': 0})","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879338E12,"submitTime":1.467681879338E12,"finishTime":1.467681905818E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"004b41ff-549f-4183-ae46-ab36a7dd667e"},{"version":"CommandV1","origId":944615974881731,"guid":"1a9ad7f8-701b-4cae-b1bb-544c7be183e9","subtype":"command","commandType":"auto","position":41.0,"command":"# Ensure that there are no nulls left.\nexprs = []\nfor col_name in cleaned_df.columns:\n  exprs.append(count_null(col_name))\n\ncleaned_df.agg(*exprs).show()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879359E12,"submitTime":1.467681879359E12,"finishTime":1.467681905819E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6f1509ab-11d4-41ab-b90a-be14a5fea1f0"},{"version":"CommandV1","origId":944615974881732,"guid":"def56af9-e477-4887-baba-648610cf3a6b","subtype":"command","commandType":"auto","position":42.0,"command":"%md\n### (2e) Parsing the timestamp.\n\nOkay, now that we have a clean, parsed DataFrame, we have to parse the timestamp field into an actual timestamp. The Common Log Format time is somewhat non-standard. A User-Defined Function (UDF) is the most straightforward way to parse it.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879382E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a452d3d5-539f-4911-bb86-d4eb9a1ab4b1"},{"version":"CommandV1","origId":2103251912673297,"guid":"4cfd1a06-6499-429f-84df-9e9bd5ce3da7","subtype":"command","commandType":"auto","position":42.5,"command":"cleaned_df.select(cleaned_df['timestamp']).show(5, truncate=False)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879404E12,"submitTime":1.467681879404E12,"finishTime":1.467681905819E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1742ad8b-6153-44cc-8a7e-9d6156f8e434"},{"version":"CommandV1","origId":944615974881733,"guid":"2b9bd753-d61c-4282-bf8e-bc8d63a4503e","subtype":"command","commandType":"auto","position":43.0,"command":"month_map = {\n  'Jan': 1, 'Feb': 2, 'Mar':3, 'Apr':4, 'May':5, 'Jun':6, 'Jul':7,\n  'Aug':8,  'Sep': 9, 'Oct':10, 'Nov': 11, 'Dec': 12\n}\n\ndef parse_clf_time(s):\n    \"\"\" Convert Common Log time format into a Python datetime object\n    Args:\n        s (str): date and time in Apache time format [dd/mmm/yyyy:hh:mm:ss (+/-)zzzz]\n    Returns:\n        a string suitable for passing to CAST('timestamp')\n    \"\"\"\n    # NOTE: We're ignoring time zone here. In a production application, you'd want to handle that.\n    return \"{0:04d}-{1:02d}-{2:02d} {3:02d}:{4:02d}:{5:02d}\".format(\n      int(s[7:11]),\n      month_map[s[3:6]],\n      int(s[0:2]),\n      int(s[12:14]),\n      int(s[15:17]),\n      int(s[18:20])\n    )\n\nu_parse_time = udf(parse_clf_time)\n\nlogs_df = cleaned_df.select('*', u_parse_time(cleaned_df['timestamp']).cast('timestamp').alias('time')).drop('timestamp')\ntotal_log_entries = logs_df.count()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879426E12,"submitTime":1.467681879426E12,"finishTime":1.46768190582E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"63ab756e-8d2c-47b6-8841-8083a272a611"},{"version":"CommandV1","origId":944615974881734,"guid":"a1486f41-b35a-4c62-bfd4-6a4b7d93dbfd","subtype":"command","commandType":"auto","position":44.0,"command":"logs_df.printSchema()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46768187945E12,"submitTime":1.46768187945E12,"finishTime":1.467681905821E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"143c3d13-76a9-454b-9e26-f6530f09a900"},{"version":"CommandV1","origId":944615974881735,"guid":"03605e9d-77c1-4716-9835-4ed14a31b842","subtype":"command","commandType":"auto","position":45.0,"command":"display(logs_df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879471E12,"submitTime":1.467681879471E12,"finishTime":1.467681905825E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d087fdff-5f19-48c4-abf3-b98f31192b36"},{"version":"CommandV1","origId":944615974881736,"guid":"b41310de-94e0-4759-835f-0c6eb201f8f2","subtype":"command","commandType":"auto","position":46.0,"command":"%md\nLet's cache `logs_df`. We're going to be using it quite a bit from here forward.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879506E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6c0a5b5e-1738-41c9-a1ff-18a34d48a68f"},{"version":"CommandV1","origId":944615974881737,"guid":"341e3da9-d64f-478b-ba6f-35f465016be9","subtype":"command","commandType":"auto","position":47.0,"command":"logs_df.cache()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879525E12,"submitTime":1.467681879525E12,"finishTime":1.467681905829E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"16f41b67-5e33-4e04-a985-bb891a537fa0"},{"version":"CommandV1","origId":944615974881738,"guid":"c6a8fdf4-fcef-4390-b64c-d18680425dca","subtype":"command","commandType":"auto","position":48.0,"command":"%md\n## Part 3: Analysis Walk-Through on the Web Server Log File\n\nNow that we have a DataFrame containing the parsed log file as a set of Row objects, we can perform various analyses.\n\n### (3a) Example: Content Size Statistics\n\nLet's compute some statistics about the sizes of content being returned by the web server. In particular, we'd like to know what are the average, minimum, and maximum content sizes.\n\nWe can compute the statistics by calling `.describe()` on the `content_size` column of `logs_df`.  The `.describe()` function returns the count, mean, stddev, min, and max of a given column.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879548E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e8797a5d-0675-439d-8c4d-032ec34c059e"},{"version":"CommandV1","origId":944615974881739,"guid":"404ffb42-1745-4e17-8041-f000aa3efc38","subtype":"command","commandType":"auto","position":49.0,"command":"# Calculate statistics based on the content size.\ncontent_size_summary_df = logs_df.describe(['content_size'])\ncontent_size_summary_df.show()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46768187957E12,"submitTime":1.46768187957E12,"finishTime":1.46768190583E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1d507c1c-d455-41a9-98d0-e8069d4ab605"},{"version":"CommandV1","origId":944615974881740,"guid":"22ea24e2-4f23-4ca7-9948-18a1352c71b5","subtype":"command","commandType":"auto","position":50.0,"command":"%md\n\nAlternatively, we can use SQL to directly calculate these statistics.  You can explore the many useful functions within the `pyspark.sql.functions` module in the [documentation](https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#module-pyspark.sql.functions).\n\nAfter we apply the `.agg()` function, we call `.first()` to extract the first value, which is equivalent to `.take(1)[0]`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879589E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0f685bcc-0c34-4d7f-a282-accebdcfbaba"},{"version":"CommandV1","origId":944615974881741,"guid":"f791a816-054c-49ac-bd02-c41035da878c","subtype":"command","commandType":"auto","position":51.0,"command":"from pyspark.sql import functions as sqlFunctions\ncontent_size_stats =  (logs_df\n                       .agg(sqlFunctions.min(logs_df['content_size']),\n                            sqlFunctions.avg(logs_df['content_size']),\n                            sqlFunctions.max(logs_df['content_size']))\n                       .first())\n\nprint 'Using SQL functions:'\nprint 'Content Size Avg: {1:,.2f}; Min: {0:.2f}; Max: {2:,.0f}'.format(*content_size_stats)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879608E12,"submitTime":1.467681879608E12,"finishTime":1.467681905831E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ab216f72-de26-48bd-a910-c43ad1bcb4ac"},{"version":"CommandV1","origId":944615974881742,"guid":"30572a1d-5f08-4cd7-8b2d-1b6300d539e9","subtype":"command","commandType":"auto","position":52.0,"command":"%md\n### (3b) Example: HTTP Status Analysis\n\nNext, let's look at the status values that appear in the log. We want to know which status values appear in the data and how many times.  We again start with `logs_df`, then group by the `status` column, apply the `.count()` aggregation function, and sort by the `status` column.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879628E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d77a38f3-67dc-4476-b144-19370cd9fa07"},{"version":"CommandV1","origId":944615974881743,"guid":"eb5cc30c-cec0-45f2-b4ff-f2292f692ebf","subtype":"command","commandType":"auto","position":53.0,"command":"status_to_count_df =(logs_df\n                     .groupBy('status')\n                     .count()\n                     .sort('status')\n                     .cache())\n\nstatus_to_count_length = status_to_count_df.count()\nprint 'Found %d response codes' % status_to_count_length\nstatus_to_count_df.show()\n\nassert status_to_count_length == 7\nassert status_to_count_df.take(100) == [(200, 940847), (302, 16244), (304, 79824), (403, 58), (404, 6185), (500, 2), (501, 17)]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879647E12,"submitTime":1.467681879647E12,"finishTime":1.467681905831E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2a1190b6-3b94-4ce9-aa4a-9bf614afd969"},{"version":"CommandV1","origId":944615974881744,"guid":"c1c7d027-cabb-4490-a8d4-d444ffd576e3","subtype":"command","commandType":"auto","position":54.0,"command":"%md\n### (3c) Example: Status Graphing\n\nNow, let's visualize the results from the last example.  We can use the built-in `display()` function to show a bar chart of the count for each response code.  After running this cell, select the bar graph option, and then use \"Plot Options...\" and drag `status` to the key entry field and drag `count` to the value entry field. See the diagram, below, for an example.\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/cs105x/plot_options_1.png\" style=\"float: right; margin-right: 30px; border: 1px solid #999999\"/>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879666E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3bbcca7c-e0eb-438e-892c-16f145b26b98"},{"version":"CommandV1","origId":944615974881745,"guid":"09d98c6f-a48b-4264-ae61-d4d5d5c9801a","subtype":"command","commandType":"auto","position":55.0,"command":"display(status_to_count_df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879686E12,"submitTime":1.467681879686E12,"finishTime":1.467681905832E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7ac15da1-0ba8-4014-9005-c866c9042c8e"},{"version":"CommandV1","origId":944615974881746,"guid":"5d4e329d-d0ce-4844-a96b-8eac49241c62","subtype":"command","commandType":"auto","position":56.0,"command":"%md\nYou can see that this is not a very effective plot.  Due to the large number of '200' codes, it is very hard to see the relative number of the others.  We can alleviate this by taking the logarithm of the count, adding that as a column to our DataFrame and displaying the result.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879705E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"23a10dcd-f89c-4325-b653-de580d9fa472"},{"version":"CommandV1","origId":944615974881747,"guid":"fb7216c5-0748-4ec0-89e4-ab42773253e3","subtype":"command","commandType":"auto","position":57.0,"command":"log_status_to_count_df = status_to_count_df.withColumn('log(count)', sqlFunctions.log(status_to_count_df['count']))\n\ndisplay(log_status_to_count_df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879723E12,"submitTime":1.467681879723E12,"finishTime":1.467681905833E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"170e59ee-9462-42f9-85ad-4172757af4aa"},{"version":"CommandV1","origId":944615974881748,"guid":"8b3e25af-5e18-426d-811a-2985b64c1a89","subtype":"command","commandType":"auto","position":58.0,"command":"%md\nWhile this graph is an improvement, we might want to make more adjustments.  The [`matplotlib` library](http://matplotlib.org/) can give us more control in our plot and is also useful outside the Databricks environment. In this case, we're essentially just reproducing the Databricks graph using `matplotlib`. However, `matplotlib` exposes far more controls than the Databricks graph, allowing you to change colors, label the axes, and more. We're using a set of helper functions from the [`spark_notebook_helpers`](https://pypi.python.org/pypi/spark_notebook_helpers/1.0.1) library.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879743E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2dbca245-c432-4619-b023-71103c1086a7"},{"version":"CommandV1","origId":944615974881749,"guid":"0fbcdb92-ea4b-4f42-beab-c06c2ed157ee","subtype":"command","commandType":"auto","position":59.0,"command":"# np is just an alias for numpy.\n# cm and plt are aliases for matplotlib.cm (for \"color map\") and matplotlib.pyplot, respectively.\n# prepareSubplot is a helper.\nfrom spark_notebook_helpers import prepareSubplot, np, plt, cm","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879763E12,"submitTime":1.467681879763E12,"finishTime":1.467681905834E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f1ff986b-8b38-4d70-be7c-79dd0c3820c9"},{"version":"CommandV1","origId":944615974881750,"guid":"50119656-2fc3-48b0-af4d-62c4e6b00181","subtype":"command","commandType":"auto","position":60.0,"command":"help(prepareSubplot)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879783E12,"submitTime":1.467681879783E12,"finishTime":1.467681905835E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"026b08c6-bbd9-41a4-862c-e15dcbcec020"},{"version":"CommandV1","origId":944615974881751,"guid":"f889d5d8-50be-4e3f-8ada-2e16a219ee8b","subtype":"command","commandType":"auto","position":61.0,"command":"%md\nWe're using the \"Set1\" color map. See the list of Qualitative Color Maps at <http://matplotlib.org/examples/color/colormaps_reference.html> for more details. Feel free to change the color map to a different one, like \"Accent\".","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879801E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"cdd66d01-9390-4034-a0de-717e9dfe770d"},{"version":"CommandV1","origId":944615974881752,"guid":"51c50ecc-65fd-4d11-9f61-e1fbc5e24aee","subtype":"command","commandType":"auto","position":62.0,"command":"data = log_status_to_count_df.drop('count').collect()\nx, y = zip(*data)\nindex = np.arange(len(x))\nbar_width = 0.7\ncolorMap = 'Set1'\ncmap = cm.get_cmap(colorMap)\n\nfig, ax = prepareSubplot(np.arange(0, 6, 1), np.arange(0, 14, 2))\nplt.bar(index, y, width=bar_width, color=cmap(0))\nplt.xticks(index + bar_width/2.0, x)\ndisplay(fig)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879821E12,"submitTime":1.467681879821E12,"finishTime":1.467681905856E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e45dc898-2944-4a4d-b155-0ae4b2a42fab"},{"version":"CommandV1","origId":944615974881753,"guid":"9bca0141-ad19-4a69-9530-76a6e84f666e","subtype":"command","commandType":"auto","position":63.0,"command":"%md\n### (3d) Example: Frequent Hosts\n\nLet's look at hosts that have accessed the server frequently (e.g., more than ten times). As with the response code analysis in (3b), we create a new DataFrame by grouping `successLogsDF` by the 'host' column and aggregating by count.\n\nWe then filter the result based on the count of accesses by each host being greater than ten.  Then, we select the 'host' column and show 20 elements from the result.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879841E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1f34b833-b89d-42bd-881a-ed731dfaf275"},{"version":"CommandV1","origId":944615974881754,"guid":"a4c1a331-6f54-47e4-802f-9b887df58b86","subtype":"command","commandType":"auto","position":64.0,"command":"# Any hosts that has accessed the server more than 10 times.\nhost_sum_df =(logs_df\n              .groupBy('host')\n              .count())\n\nhost_more_than_10_df = (host_sum_df\n                        .filter(host_sum_df['count'] > 10)\n                        .select(host_sum_df['host']))\n\nprint 'Any 20 hosts that have accessed more then 10 times:\\n'\nhost_more_than_10_df.show(truncate=False)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879861E12,"submitTime":1.467681879861E12,"finishTime":1.467681905857E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e523a663-20a6-43e5-aa8e-f1c3631d73b3"},{"version":"CommandV1","origId":944615974881755,"guid":"6b20b1b8-c003-4bd6-8643-42b7489fcb9c","subtype":"command","commandType":"auto","position":65.0,"command":"%md\n### (3e) Example: Visualizing Paths\n\nNow, let's visualize the number of hits to paths (URIs) in the log. To perform this task, we start with our `logs_df` and group by the `path` column, aggregate by count, and sort in descending order.\n\nNext we visualize the results using `matplotlib`. We previously imported the `prepareSubplot` function and the `matplotlib.pyplot` library, so we do not need to import them again.  We extract the paths and the counts, and unpack the resulting list of `Rows` using a `map` function and `lambda` expression.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879881E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7b303aec-e70a-43d8-ae05-be53a50341e9"},{"version":"CommandV1","origId":944615974881756,"guid":"86e5560c-c2f2-43dd-bf79-db26ac763b53","subtype":"command","commandType":"auto","position":66.0,"command":"paths_df = (logs_df\n            .groupBy('path')\n            .count()\n            .sort('count', ascending=False))\n\npaths_counts = (paths_df\n                .select('path', 'count')\n                .map(lambda r: (r[0], r[1]))\n                .collect())\n\npaths, counts = zip(*paths_counts)\n\ncolorMap = 'Accent'\ncmap = cm.get_cmap(colorMap)\nindex = np.arange(1000)\n\nfig, ax = prepareSubplot(np.arange(0, 1000, 100), np.arange(0, 70000, 10000))\nplt.xlabel('Paths')\nplt.ylabel('Number of Hits')\nplt.plot(index, counts[:1000], color=cmap(0), linewidth=3)\nplt.axhline(linewidth=2, color='#999999')\ndisplay(fig)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.4676818799E12,"submitTime":1.4676818799E12,"finishTime":1.467681905858E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"eb8c6a18-f2a2-43c4-ad74-9a2dae01d075"},{"version":"CommandV1","origId":944615974881757,"guid":"9cb4c69b-1fa1-4f8c-9cb3-405df98b48b9","subtype":"command","commandType":"auto","position":67.0,"command":"%md\nWe can also visualize the results as a line graph using the built-in Databricks `display` function to graph the results.  After calling this function on `paths_df`, select the line graph option.\n\nThe graph is plotted using the first 1,000 rows of data. To see a more complete plot, click on the \"Plot over all results\" link. Be prepared to wait a minute or so.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879919E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4d4eb858-bd84-4b75-ad6a-2bebcfd92a73"},{"version":"CommandV1","origId":944615974881758,"guid":"aad9e35e-4602-4615-8a83-54d285b241f3","subtype":"command","commandType":"auto","position":68.0,"command":"display(paths_df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681879937E12,"submitTime":1.467681879937E12,"finishTime":1.467681905861E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4b4e8752-b3c7-4c27-beba-69861016434c"},{"version":"CommandV1","origId":944615974881759,"guid":"38c17bfc-74db-4f99-9805-60fbb3cf6298","subtype":"command","commandType":"auto","position":69.0,"command":"%md\n### (3f) Example: Top Paths\n\nFor the final example, we'll find the top paths (URIs) in the log.  Because we sorted `paths_df` for plotting, all we need to do is call `.show()` and pass in `n=10` and `truncate=False` as the parameters to show the top ten paths without truncating.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879963E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8f552dd1-2622-472d-a9f7-0092d5d00e8f"},{"version":"CommandV1","origId":944615974881760,"guid":"40b9431c-dfbe-4b76-8d5d-43fe86a77223","subtype":"command","commandType":"auto","position":70.0,"command":"# Top Paths\nprint 'Top Ten Paths:'\npaths_df.show(n=10, truncate=False)\n\nexpected = [\n  (u'/images/NASA-logosmall.gif', 59666),\n  (u'/images/KSC-logosmall.gif', 50420),\n  (u'/images/MOSAIC-logosmall.gif', 43831),\n  (u'/images/USA-logosmall.gif', 43604),\n  (u'/images/WORLD-logosmall.gif', 43217),\n  (u'/images/ksclogo-medium.gif', 41267),\n  (u'/ksc.html', 28536),\n  (u'/history/apollo/images/apollo-logo1.gif', 26766),\n  (u'/images/launch-logo.gif', 24742),\n  (u'/', 20173)\n]\nassert paths_df.take(10) == expected, 'incorrect Top Ten Paths'","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46768187998E12,"submitTime":1.46768187998E12,"finishTime":1.467681905864E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"41a0ed42-5f58-4ee6-88a8-3cc6d8b201c8"},{"version":"CommandV1","origId":944615974881761,"guid":"c188dbe1-b3b0-4f14-99ab-a9f8757c565c","subtype":"command","commandType":"auto","position":71.0,"command":"%md\n### Part 4: Analyzing Web Server Log File\n\nNow it is your turn to perform analyses on the web server log files.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681879997E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e823b93a-5d63-42fe-a9a2-107ccabdfb1d"},{"version":"CommandV1","origId":944615974881762,"guid":"8628173a-01c4-4510-8496-bc05343b0592","subtype":"command","commandType":"auto","position":72.0,"command":"%md\n**(4a) Exercise: Top Ten Error Paths**\n\nWhat are the top ten paths which did not have return code 200? Create a sorted list containing the paths and the number of times that they were accessed with a non-200 return code and show the top ten.\n\nThink about the steps that you need to perform to determine which paths did not have a 200 return code, how you will uniquely count those paths and sort the list.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880014E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e487aca9-9a65-4d27-ae60-15739bac80ef"},{"version":"CommandV1","origId":944615974881763,"guid":"30a57a76-620f-45e8-a950-4a036d6a8737","subtype":"command","commandType":"auto","position":73.0,"command":"# TODO: Replace <FILL IN> with appropriate code\n# You are welcome to structure your solution in a different way, so long as\n# you ensure the variables used in the next Test section are defined\n\n# DataFrame containing all accesses that did not return a code 200\nfrom pyspark.sql.functions import desc\nnot200DF = logs_df.select('*').filter(logs_df.status != 200)\nnot200DF.show(10)\n# Sorted DataFrame containing all paths and the number of times they were accessed with non-200 return code\nlogs_sum_df = not200DF.groupBy('path').count().sort('count', ascending = False)\n\nprint 'Top Ten failed URLs:'\nlogs_sum_df.show(10, False)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880032E12,"submitTime":1.467681880032E12,"finishTime":1.467681905865E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ca86d056-b3db-4523-a4c7-f8d0146007ed"},{"version":"CommandV1","origId":2103251912673304,"guid":"18ff382a-2bec-46a9-8447-aec7e103a9f5","subtype":"command","commandType":"auto","position":73.5,"command":"logs_df.show(3)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880049E12,"submitTime":1.467681880049E12,"finishTime":1.467681905865E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"489e39eb-98a0-4b1d-a2de-0354cfcc0064"},{"version":"CommandV1","origId":944615974881764,"guid":"e94e8b06-6b18-4916-a06a-f0531acd0223","subtype":"command","commandType":"auto","position":74.0,"command":"# TEST Top ten error paths (4a)\ntop_10_err_urls = [(row[0], row[1]) for row in logs_sum_df.take(10)]\ntop_10_err_expected = [\n  (u'/images/NASA-logosmall.gif', 8761),\n  (u'/images/KSC-logosmall.gif', 7236),\n  (u'/images/MOSAIC-logosmall.gif', 5197),\n  (u'/images/USA-logosmall.gif', 5157),\n  (u'/images/WORLD-logosmall.gif', 5020),\n  (u'/images/ksclogo-medium.gif', 4728),\n  (u'/history/apollo/images/apollo-logo1.gif', 2907),\n  (u'/images/launch-logo.gif', 2811),\n  (u'/', 2199),\n  (u'/images/ksclogosmall.gif', 1622)\n]\nTest.assertEquals(logs_sum_df.count(), 7675, 'incorrect count for logs_sum_df')\nTest.assertEquals(top_10_err_urls, top_10_err_expected, 'incorrect Top Ten failed URLs')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880067E12,"submitTime":1.467681880067E12,"finishTime":1.467681905866E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f1817ec4-9ec1-4501-9a03-097ca7b303e8"},{"version":"CommandV1","origId":944615974881765,"guid":"8a88489c-53de-42aa-a14d-d96a66b42533","subtype":"command","commandType":"auto","position":75.0,"command":"%md\n### (4b) Exercise: Number of Unique Hosts\n\nHow many unique hosts are there in the entire log?\n\nThere are multiple ways to find this.  Try to find a more optimal way than grouping by 'host'.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880083E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"81d3da05-d02b-4805-9c50-dc20527af38c"},{"version":"CommandV1","origId":944615974881766,"guid":"31766d23-d13a-4396-9739-2381658458c1","subtype":"command","commandType":"auto","position":76.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nunique_host_count = logs_df.select('host').distinct().count()\nprint 'Unique hosts: {0}'.format(unique_host_count)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.4676818801E12,"submitTime":1.4676818801E12,"finishTime":1.467681905867E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"58cd7819-ae27-40db-a68d-aecc60a31701"},{"version":"CommandV1","origId":944615974881767,"guid":"c2e76d9f-2bbd-4612-b325-85995987f74d","subtype":"command","commandType":"auto","position":77.0,"command":"# TEST Number of unique hosts (4b)\nTest.assertEquals(unique_host_count, 54507, 'incorrect unique_host_count')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880133E12,"submitTime":1.467681880133E12,"finishTime":1.467681905867E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1a3195de-bd71-4587-94c8-68a49fd6f388"},{"version":"CommandV1","origId":944615974881768,"guid":"2d7505c5-3667-4a51-abef-cc9b05aab1dc","subtype":"command","commandType":"auto","position":78.0,"command":"%md\n### (4c) Exercise: Number of Unique Daily Hosts\n\nFor an advanced exercise, let's determine the number of unique hosts in the entire log on a day-by-day basis. This computation will give us counts of the number of unique daily hosts. We'd like a DataFrame sorted by increasing day of the month which includes the day of the month and the associated number of unique hosts for that day. Make sure you cache the resulting DataFrame `daily_hosts_df` so that we can reuse it in the next exercise.\n\nThink about the steps that you need to perform to count the number of different hosts that make requests *each* day.\n*Since the log only covers a single month, you can ignore the month.*  You may want to use the [`dayofmonth` function](https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.dayofmonth) in the `pyspark.sql.functions` module.\n\n**Description of each variable**\n\n**`day_to_host_pair_df`**\n\nA DataFrame with two columns\n\n| column | explanation          |\n| ------ | -------------------- |\n| `host` | the host name        |\n| `day`  | the day of the month |\n\nThere will be one row in this DataFrame for each row in `logs_df`. Essentially, you're just trimming and transforming each row of `logs_df`. For example, for this row in `logs_df`:\n\n```\ngw1.att.com - - [23/Aug/1995:00:03:53 -0400] \"GET /shuttle/missions/sts-73/news HTTP/1.0\" 302 -\n```\n\nyour `day_to_host_pair_df` should have:\n\n```\ngw1.att.com 23\n```\n\n**`day_group_hosts_df`**\n\nThis DataFrame has the same columns as `day_to_host_pair_df`, but with duplicate (`day`, `host`) rows removed.\n\n**`daily_hosts_df`**\n\nA DataFrame with two columns:\n\n| column  | explanation                                        |\n| ------- | -------------------------------------------------- |\n| `day`   | the day of the month                               |\n| `count` | the number of unique requesting hosts for that day |","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46768188015E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a6f46409-09e7-4d47-8408-257ff21dfa67"},{"version":"CommandV1","origId":944615974881769,"guid":"db0d3c2b-2ed2-4500-824b-04e3760156af","subtype":"command","commandType":"auto","position":79.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfrom pyspark.sql.functions import dayofmonth\n\nday_to_host_pair_df = logs_df.select('host', dayofmonth('time').alias('day'))\nday_group_hosts_df = day_to_host_pair_df.dropDuplicates(['host', 'day'])\ndaily_hosts_df = day_group_hosts_df.groupBy('day').count()\n\nprint 'Unique hosts per day:'\ndaily_hosts_df.show(30, False)\ndaily_hosts_df.cache()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880168E12,"submitTime":1.467681880168E12,"finishTime":1.467681905868E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"96666ce7-ccb8-4183-913a-628c38f463ea"},{"version":"CommandV1","origId":944615974881770,"guid":"a225ac9e-d098-4a3d-a257-0e3b9dff3a03","subtype":"command","commandType":"auto","position":80.0,"command":"# TEST Number of unique daily hosts (4c)\ndaily_hosts_list = (daily_hosts_df\n                    .map(lambda r: (r[0], r[1]))\n                    .take(30))\n\nTest.assertEquals(day_to_host_pair_df.count(), total_log_entries, 'incorrect row count for day_to_host_pair_df')\nTest.assertEquals(daily_hosts_df.count(), 21, 'incorrect daily_hosts_df.count()')\nTest.assertEquals(daily_hosts_list, [(1, 2582), (3, 3222), (4, 4190), (5, 2502), (6, 2537), (7, 4106), (8, 4406), (9, 4317), (10, 4523), (11, 4346), (12, 2864), (13, 2650), (14, 4454), (15, 4214), (16, 4340), (17, 4385), (18, 4168), (19, 2550), (20, 2560), (21, 4134), (22, 4456)], 'incorrect daily_hosts_df')\nTest.assertTrue(daily_hosts_df.is_cached, 'incorrect daily_hosts_df.is_cached')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880185E12,"submitTime":1.467681880185E12,"finishTime":1.467681905869E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"cbf1e73b-58a9-4ec0-8bfd-66c294b5160c"},{"version":"CommandV1","origId":944615974881771,"guid":"edbc1d9d-054e-47e0-b004-4e7c2a93ec12","subtype":"command","commandType":"auto","position":81.0,"command":"%md\n### (4d) Exercise: Visualizing the Number of Unique Daily Hosts\n\nUsing the results from the previous exercise, we will use `matplotlib` to plot a line graph of the unique hosts requests by day.  We need a list of days called `days_with_hosts` and a list of the number of unique hosts for each corresponding day called `hosts`.\n\n**WARNING**: Simply calling `collect()` on your transformed DataFrame won't work, because `collect()` returns a list of Spark SQL `Row` objects. You must _extract_ the appropriate column values from the `Row` objects. Hint: A loop will help.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880201E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"afbb04b9-9b33-4b13-8b57-656f2fe6d63d"},{"version":"CommandV1","origId":944615974881772,"guid":"69e502fa-e3c0-41fa-93ba-b639491c6753","subtype":"command","commandType":"auto","position":82.0,"command":"vLst = daily_hosts_df.collect()\ndays_with_hostsT, hostsT = zip(*Lst)\n\ndays_with_hosts = []\nhosts = []\nfor i in range(len(hostsT)):\n  days_with_hosts.append(days_with_hostsT[i])\n  hosts.append(hostT[i])\n\nprint(days_with_hosts)  \nprint(hosts)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880218E12,"submitTime":1.467681880218E12,"finishTime":1.46768190587E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5359349c-2db7-4477-8139-f4c26476a3f3"},{"version":"CommandV1","origId":944615974881773,"guid":"31c0f297-0889-42da-bf25-cadd7f4153ce","subtype":"command","commandType":"auto","position":83.0,"command":"# TEST Visualizing unique daily hosts (4d)\ntest_days = range(1, 23)\ntest_days.remove(2)\nTest.assertEquals(days_with_hosts, test_days, 'incorrect days')\nTest.assertEquals(hosts, [2582, 3222, 4190, 2502, 2537, 4106, 4406, 4317, 4523, 4346, 2864, 2650, 4454, 4214, 4340, 4385, 4168, 2550, 2560, 4134, 4456], 'incorrect hosts')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880233E12,"submitTime":1.467681880233E12,"finishTime":1.46768190587E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2f80e014-c4bb-4a18-8aac-e9a7c8726393"},{"version":"CommandV1","origId":944615974881774,"guid":"75b3f342-7e07-4696-a58e-83ce7f4b04c5","subtype":"command","commandType":"auto","position":84.0,"command":"fig, ax = prepareSubplot(np.arange(0, 30, 5), np.arange(0, 5000, 1000))\ncolorMap = 'Dark2'\ncmap = cm.get_cmap(colorMap)\nplt.plot(days_with_hosts, hosts, color=cmap(0), linewidth=3)\nplt.axis([0, max(days_with_hosts), 0, max(hosts)+500])\nplt.xlabel('Day')\nplt.ylabel('Hosts')\nplt.axhline(linewidth=3, color='#999999')\nplt.axvline(linewidth=2, color='#999999')\ndisplay(fig)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46768188025E12,"submitTime":1.46768188025E12,"finishTime":1.467681905871E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8f659d08-52a8-4a64-b13d-6358b71b365c"},{"version":"CommandV1","origId":944615974881775,"guid":"68f1a4cc-ea7f-4219-9059-fc817067a630","subtype":"command","commandType":"auto","position":85.0,"command":"%md\nYou can also pass in the `day_host_count_df` DataFrame into Databricks plots to plot a line or bar graph of the unique hosts requests by day.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880266E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9079d1d6-0632-41c5-aaa6-02234494dc9a"},{"version":"CommandV1","origId":944615974881776,"guid":"ff76bde2-10d1-4ec4-9b53-ad6ab2a66522","subtype":"command","commandType":"auto","position":86.0,"command":"display(daily_hosts_df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880285E12,"submitTime":1.467681880285E12,"finishTime":1.467681905872E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d4a1e70f-dab0-4a24-9006-16e0876fab3b"},{"version":"CommandV1","origId":944615974881777,"guid":"04d1617e-8eb0-4702-b696-e449a5648e3a","subtype":"command","commandType":"auto","position":87.0,"command":"%md\n### (4e) Exercise: Average Number of Daily Requests per Host\n\nNext, let's determine the average number of requests on a day-by-day basis.  We'd like a list by increasing day of the month and the associated average number of requests per host for that day. Make sure you cache the resulting DataFrame `avg_daily_req_per_host_df` so that we can reuse it in the next exercise.\n\nTo compute the average number of requests per host, find the total number of requests per day (across all hosts) and divide that by the number of unique hosts per day (which we found in part 4c and cached as `daily_hosts_df`).\n\n*Since the log only covers a single month, you can skip checking for the month.*","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880302E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"46caa9fb-1351-4fdc-ae8e-adb85f14f3ee"},{"version":"CommandV1","origId":944615974881778,"guid":"a30214ec-ece8-4227-a8cd-3cad0ce1de2c","subtype":"command","commandType":"auto","position":88.0,"command":"total_req_per_day_df = logs_df.select('host', dayofmonth('time').alias('day')).groupBy('day').count()\navg_daily_req_per_host_df = (total_req_per_day_df.alias('total')\n                             .join(daily_hosts_df.alias('hosts'), 'day')\n                             .select(col('day'), (col('total.count')/col('hosts.count')).cast('integer').alias('avg_reqs_per_host_per_day'))\n                            )\nprint 'Average number of daily requests per Hosts is:\\n'\navg_daily_req_per_host_df.show()\navg_daily_req_per_host_df.cache()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880323E12,"submitTime":1.467681880323E12,"finishTime":1.467681905873E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b1dd28bf-133b-4d5d-bef1-87c8d4666968"},{"version":"CommandV1","origId":944615974881779,"guid":"35422d92-f869-4d17-9ac9-1800338ea88e","subtype":"command","commandType":"auto","position":89.0,"command":"# TEST Average number of daily requests per hosts (4e)\navg_daily_req_per_host_list = (\n  avg_daily_req_per_host_df.select('day', avg_daily_req_per_host_df['avg_reqs_per_host_per_day'].cast('integer').alias('avg_requests'))\n                           .collect()\n)\n\nvalues = [(row[0], row[1]) for row in avg_daily_req_per_host_list]\nprint values\nTest.assertEquals(values, [(1, 13), (3, 12), (4, 14), (5, 12), (6, 12), (7, 13), (8, 13), (9, 14), (10, 13), (11, 14), (12, 13), (13, 13), (14, 13), (15, 13), (16, 13), (17, 13), (18, 13), (19, 12), (20, 12), (21, 13), (22, 12)], 'incorrect avgDailyReqPerHostDF')\nTest.assertTrue(avg_daily_req_per_host_df.is_cached, 'incorrect avg_daily_req_per_host_df.is_cached')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880339E12,"submitTime":1.467681880339E12,"finishTime":1.467681905873E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"40b57438-779f-43c0-bd8b-d2c94940187b"},{"version":"CommandV1","origId":944615974881780,"guid":"9ab2d954-9d50-440d-82b0-f04a341b79ed","subtype":"command","commandType":"auto","position":90.0,"command":"%md\n### (4f) Exercise: Visualizing the Average Daily Requests per Unique Host\n\nUsing the result `avg_daily_req_per_host_df` from the previous exercise, use `matplotlib` to plot a line graph of the average daily requests per unique host by day.\n\n`days_with_avg` should be a list of days and `avgs` should be a list of average daily requests (as integers) per unique hosts for each corresponding day.  Hint: You will need to extract these from the Dataframe in a similar way to part 4d.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880355E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5f39184e-8f4e-4b52-99ee-ff4d42935295"},{"version":"CommandV1","origId":2103251912673317,"guid":"133aad89-97b8-445f-a84f-5f2faa77e875","subtype":"command","commandType":"auto","position":90.5,"command":"avg_daily_req_per_host_df.show(4)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880372E12,"submitTime":1.467681880372E12,"finishTime":1.467681905874E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"75e682be-4564-4132-8acc-1176f39f6054"},{"version":"CommandV1","origId":944615974881781,"guid":"5f6fbd65-2522-4f9a-aa5c-f9bb5e400f53","subtype":"command","commandType":"auto","position":91.0,"command":"days_with_avg = [row['day'] for row in avg_daily_req_per_host_df.select('day').collect()]\navgs = [row['avg_reqs_per_host_per_day'] for row in avg_daily_req_per_host_df.select('avg_reqs_per_host_per_day').collect()]\n\nprint(days_with_avg)\nprint(avgs)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46768188039E12,"submitTime":1.46768188039E12,"finishTime":1.467681905875E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a43428ee-5323-45d8-a733-156808572071"},{"version":"CommandV1","origId":944615974881782,"guid":"8226b72b-649d-4990-a765-db152d79845a","subtype":"command","commandType":"auto","position":92.0,"command":"# TEST Average Daily Requests per Unique Host (4f)\nTest.assertEquals(days_with_avg, [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'incorrect days')\nTest.assertEquals([int(a) for a in avgs], [13, 12, 14, 12, 12, 13, 13, 14, 13, 14, 13, 13, 13, 13, 13, 13, 13, 12, 12, 13, 12], 'incorrect avgs')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880593E12,"submitTime":1.467681880593E12,"finishTime":1.467681905875E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ecae9652-1ebd-41b8-bb42-614caf7b24ca"},{"version":"CommandV1","origId":944615974881783,"guid":"eff143dd-0b2d-4419-8484-e473b135b333","subtype":"command","commandType":"auto","position":93.0,"command":"fig, ax = prepareSubplot(np.arange(0, 20, 5), np.arange(0, 16, 2))\ncolorMap = 'Set3'\ncmap = cm.get_cmap(colorMap)\nplt.plot(days_with_avg, avgs, color=cmap(0), linewidth=3)\nplt.axis([0, max(days_with_avg), 0, max(avgs)+2])\nplt.xlabel('Day')\nplt.ylabel('Average')\nplt.axhline(linewidth=3, color='#999999')\nplt.axvline(linewidth=2, color='#999999')\ndisplay(fig)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880616E12,"submitTime":1.467681880616E12,"finishTime":1.467681905876E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"19909b71-66d0-46a8-a76e-830f7afbdaa4"},{"version":"CommandV1","origId":944615974881784,"guid":"ba9a86fd-d8e1-4572-a2fb-732af127049c","subtype":"command","commandType":"auto","position":94.0,"command":"%md\nAs a comparison to the prior plot, use the Databricks `display` function to plot a line graph of the average daily requests per unique host by day.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880639E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8a91caaf-66e5-4a8b-9ecf-2522218f87bd"},{"version":"CommandV1","origId":944615974881785,"guid":"cb7835bb-dde4-491c-b12f-44ad159055e2","subtype":"command","commandType":"auto","position":95.0,"command":"display(avg_daily_req_per_host_df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880662E12,"submitTime":1.467681880662E12,"finishTime":1.467681905877E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7d7617db-418a-44af-82bd-3a7057cb55d5"},{"version":"CommandV1","origId":944615974881786,"guid":"d1c07555-87ab-4615-88c3-314967d43089","subtype":"command","commandType":"auto","position":96.0,"command":"%md\n## Part 5: Exploring 404 Status Codes\n\nLet's drill down and explore the error 404 status records. We've all seen those \"404 Not Found\" web pages. 404 errors are returned when the server cannot find the resource (page or object) the browser or client requested.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880684E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0101b7d6-1313-4a21-8009-6469abe3db93"},{"version":"CommandV1","origId":944615974881787,"guid":"a8af496d-2454-40e0-855d-d0e11d75459d","subtype":"command","commandType":"auto","position":97.0,"command":"%md\n### (5a) Exercise: Counting 404 Response Codes\n\nCreate a DataFrame containing only log records with a 404 status code. Make sure you `cache()` `not_found_df` as we will use it in the rest of this exercise.\n\nHow many 404 records are in the log?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880707E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a84b95d3-5c4d-4b99-8981-47b43b476602"},{"version":"CommandV1","origId":944615974881788,"guid":"115c3522-26ea-4f74-be83-efe87cbd1d2e","subtype":"command","commandType":"auto","position":98.0,"command":"not_found_df = logs_df.select('*').filter(logs_df['status'] == 404)\nprint('Found {0} 404 URLs').format(not_found_df.count())\nnot_found_df.cache()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46768188073E12,"submitTime":1.46768188073E12,"finishTime":1.467681905878E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"caef1a51-0628-4b1f-9cf5-da928ae847c9"},{"version":"CommandV1","origId":944615974881789,"guid":"b7af6e75-6320-443b-acf9-d213aa3c1246","subtype":"command","commandType":"auto","position":99.0,"command":"# TEST Counting 404 (5a)\nTest.assertEquals(not_found_df.count(), 6185, 'incorrect not_found_df.count()')\nTest.assertTrue(not_found_df.is_cached, 'incorrect not_found_df.is_cached')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880754E12,"submitTime":1.467681880754E12,"finishTime":1.467681905878E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8313c028-ece1-4601-a0d3-8d952a788019"},{"version":"CommandV1","origId":944615974881790,"guid":"0d2dc270-294f-4c9f-b648-62ca49dd82b2","subtype":"command","commandType":"auto","position":100.0,"command":"%md\n### (5b) Exercise: Listing 404 Status Code Records\n\nUsing the DataFrame containing only log records with a 404 status code that you cached in part (5a), print out a list up to 40 _distinct_ paths that generate 404 errors.\n\n**No path should appear more than once in your list.**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880776E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a4cfcd9e-1651-4b63-a17a-ff054faf6067"},{"version":"CommandV1","origId":944615974881791,"guid":"9440fdb6-22d7-4e05-961f-0943a053cc00","subtype":"command","commandType":"auto","position":101.0,"command":"not_found_paths_df = not_found_df.select('path')\nunique_not_found_paths_df = not_found_paths_df.select('path').distinct()\n\nprint '404 URLS:\\n'\nunique_not_found_paths_df.show(n=40, truncate=False)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880801E12,"submitTime":1.467681880801E12,"finishTime":1.467681905879E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"40e46c64-f586-45bc-b4a6-465cb40320c9"},{"version":"CommandV1","origId":944615974881792,"guid":"bced6cbe-3781-4119-b566-ad68e44fdd2a","subtype":"command","commandType":"auto","position":102.0,"command":"# TEST Listing 404 records (5b)\n\nbad_unique_paths_40 = set([row[0] for row in unique_not_found_paths_df.take(40)])\nTest.assertEquals(len(bad_unique_paths_40), 40, 'bad_unique_paths_40 not distinct')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880825E12,"submitTime":1.467681880825E12,"finishTime":1.46768190588E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"73cd074c-6cc4-40be-b56e-38b676e55a0a"},{"version":"CommandV1","origId":944615974881793,"guid":"c184430b-1c77-4d88-b355-a8e8bf78bef3","subtype":"command","commandType":"auto","position":103.0,"command":"%md\n### (5c) Exercise: Listing the Top Twenty 404 Response Code paths\n\nUsing the DataFrame containing only log records with a 404 response code that you cached in part (5a), print out a list of the top twenty paths that generate the most 404 errors.\n\n*Remember, top paths should be in sorted order*","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880848E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ca899ea0-2e80-4941-895b-fab3c656b8c6"},{"version":"CommandV1","origId":944615974881794,"guid":"8f99c49f-a2aa-4de8-a036-a47968ac76bb","subtype":"command","commandType":"auto","position":104.0,"command":"top_20_not_found_df = not_found_paths_df.groupBy('path').count().sort('count', ascending = False)\n\nprint 'Top Twenty 404 URLs:\\n'\ntop_20_not_found_df.show(n=20, truncate=False)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880871E12,"submitTime":1.467681880871E12,"finishTime":1.46768190588E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"29397970-ba61-46d8-883e-c4f3fb0d1498"},{"version":"CommandV1","origId":944615974881795,"guid":"52928023-3dba-40e6-a1b1-f4f37db72e0f","subtype":"command","commandType":"auto","position":105.0,"command":"# TEST Top twenty 404 URLs (5c)\n\ntop_20_not_found = [(row[0], row[1]) for row in top_20_not_found_df.take(20)]\ntop_20_expected = [\n (u'/pub/winvn/readme.txt', 633),\n (u'/pub/winvn/release.txt', 494),\n (u'/shuttle/missions/STS-69/mission-STS-69.html', 430),\n (u'/images/nasa-logo.gif', 319),\n (u'/elv/DELTA/uncons.htm', 178),\n (u'/shuttle/missions/sts-68/ksc-upclose.gif', 154),\n (u'/history/apollo/sa-1/sa-1-patch-small.gif', 146),\n (u'/images/crawlerway-logo.gif', 120),\n (u'/://spacelink.msfc.nasa.gov', 117),\n (u'/history/apollo/pad-abort-test-1/pad-abort-test-1-patch-small.gif', 100),\n (u'/history/apollo/a-001/a-001-patch-small.gif', 97),\n (u'/images/Nasa-logo.gif', 85),\n (u'', 76),\n (u'/shuttle/resources/orbiters/atlantis.gif', 63),\n (u'/history/apollo/images/little-joe.jpg', 62),\n (u'/images/lf-logo.gif', 59),\n (u'/shuttle/resources/orbiters/discovery.gif', 56),\n (u'/shuttle/resources/orbiters/challenger.gif', 54),\n (u'/robots.txt', 53),\n (u'/history/apollo/pad-abort-test-2/pad-abort-test-2-patch-small.gif', 38)\n]\nTest.assertEquals(top_20_not_found, top_20_expected, 'incorrect top_20_not_found')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880894E12,"submitTime":1.467681880894E12,"finishTime":1.467681905881E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fff19b74-f753-4fcc-ad02-23018e9f25ef"},{"version":"CommandV1","origId":944615974881796,"guid":"1cfed8b4-c225-4976-a0d0-c406a45ad27b","subtype":"command","commandType":"auto","position":106.0,"command":"%md\n### (5d) Exercise: Listing the Top Twenty-five 404 Response Code Hosts\n\nInstead of looking at the paths that generated 404 errors, let's look at the hosts that encountered 404 errors. Using the DataFrame containing only log records with a 404 status codes that you cached in part (5a), print out a list of the top twenty-five hosts that generate the most 404 errors.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880915E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a11b4fce-72d8-494d-b427-42fe839397a8"},{"version":"CommandV1","origId":944615974881797,"guid":"0a4d13b2-75eb-4247-9f73-b5ed06eb0883","subtype":"command","commandType":"auto","position":107.0,"command":"hosts_404_count_df = not_found_df.groupBy('host').count().sort('count', ascending = False)\n\nprint 'Top 25 hosts that generated errors:\\n'\nhosts_404_count_df.show(n=25, truncate=False)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880937E12,"submitTime":1.467681880937E12,"finishTime":1.467681905882E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"21cad95c-eb7b-423d-8d2b-1515426b6215"},{"version":"CommandV1","origId":944615974881798,"guid":"4f078377-34e0-4c32-83df-ee9fb071f24d","subtype":"command","commandType":"auto","position":108.0,"command":"# TEST Top twenty-five 404 response code hosts (4d)\n\ntop_25_404 = [(row[0], row[1]) for row in hosts_404_count_df.take(25)]\nTest.assertEquals(len(top_25_404), 25, 'length of errHostsTop25 is not 25')\n\nexpected = set([\n  (u'maz3.maz.net ', 39),\n  (u'piweba3y.prodigy.com ', 39),\n  (u'gate.barr.com ', 38),\n  (u'nexus.mlckew.edu.au ', 37),\n  (u'ts8-1.westwood.ts.ucla.edu ', 37),\n  (u'm38-370-9.mit.edu ', 37),\n  (u'204.62.245.32 ', 33),\n  (u'spica.sci.isas.ac.jp ', 27),\n  (u'163.206.104.34 ', 27),\n  (u'www-d4.proxy.aol.com ', 26),\n  (u'203.13.168.17 ', 25),\n  (u'203.13.168.24 ', 25),\n  (u'www-c4.proxy.aol.com ', 25),\n  (u'internet-gw.watson.ibm.com ', 24),\n  (u'crl5.crl.com ', 23),\n  (u'piweba5y.prodigy.com ', 23),\n  (u'scooter.pa-x.dec.com ', 23),\n  (u'onramp2-9.onr.com ', 22),\n  (u'slip145-189.ut.nl.ibm.net ', 22),\n  (u'198.40.25.102.sap2.artic.edu ', 21),\n  (u'msp1-16.nas.mr.net ', 20),\n  (u'gn2.getnet.com ', 20),\n  (u'tigger.nashscene.com ', 19),\n  (u'dial055.mbnet.mb.ca ', 19),\n  (u'isou24.vilspa.esa.es ', 19)\n])\nTest.assertEquals(len(set(top_25_404) - expected), 0, 'incorrect hosts_404_count_df')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681880959E12,"submitTime":1.467681880959E12,"finishTime":1.467681905882E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a36d390f-f0e7-40c6-bae7-28a58c95e606"},{"version":"CommandV1","origId":944615974881799,"guid":"5fc2280f-d4eb-485a-99fa-5c1813138b56","subtype":"command","commandType":"auto","position":109.0,"command":"%md\n### (5e) Exercise: Listing 404 Errors per Day\n\nLet's explore the 404 records temporally. Break down the 404 requests by day (cache the `errors_by_date_sorted_df` DataFrame) and get the daily counts sorted by day in `errors_by_date_sorted_df`.\n\n*Since the log only covers a single month, you can ignore the month in your checks.*","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681880981E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c681ef94-8029-4381-82b9-08c266853183"},{"version":"CommandV1","origId":944615974881800,"guid":"07a5ea8a-34b5-42fa-8027-828f41528e5f","subtype":"command","commandType":"auto","position":110.0,"command":"errors_by_date_sorted_df = not_found_df.select('status', dayofmonth('time').alias('day')).drop('time').groupBy('day').count().sort('day')\n\nprint '404 Errors by day:\\n'\nerrors_by_date_sorted_df.cache()\nerrors_by_date_sorted_df.show()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881003E12,"submitTime":1.467681881003E12,"finishTime":1.467681905883E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7279db0f-82b6-4bd7-9983-b10b9e5c3244"},{"version":"CommandV1","origId":944615974881801,"guid":"8dc40788-7f31-4d7c-8d97-ca701533f3c4","subtype":"command","commandType":"auto","position":111.0,"command":"# TEST 404 response codes per day (5e)\n\nerrors_by_date = [(row[0], row[1]) for row in errors_by_date_sorted_df.collect()]\nexpected = [\n  (1, 243),\n  (3, 303),\n  (4, 346),\n  (5, 234),\n  (6, 372),\n  (7, 532),\n  (8, 381),\n  (9, 279),\n  (10, 314),\n  (11, 263),\n  (12, 195),\n  (13, 216),\n  (14, 287),\n  (15, 326),\n  (16, 258),\n  (17, 269),\n  (18, 255),\n  (19, 207),\n  (20, 312),\n  (21, 305),\n  (22, 288)\n]\nTest.assertEquals(errors_by_date, expected, 'incorrect errors_by_date_sorted_df')\nTest.assertTrue(errors_by_date_sorted_df.is_cached, 'incorrect errors_by_date_sorted_df.is_cached')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881025E12,"submitTime":1.467681881025E12,"finishTime":1.467681905884E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d66689a8-7201-4880-81cd-a0e0253e78d8"},{"version":"CommandV1","origId":944615974881802,"guid":"49cd6562-f723-4a2f-a659-5dfe6dc4e6d8","subtype":"command","commandType":"auto","position":112.0,"command":"%md\n### (5f) Exercise: Visualizing the 404 Errors by Day\n\nUsing the results from the previous exercise, use `matplotlib` to plot a line or bar graph of the 404 response codes by day.\n\n**Hint**: You'll need to use the same technique you used in (4f).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881047E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"01bb9e0c-a2bf-472c-806b-256c2564282e"},{"version":"CommandV1","origId":944615974881803,"guid":"cf47c978-4060-4430-a45c-4398b4f0c21c","subtype":"command","commandType":"auto","position":113.0,"command":"days_with_errors_404 = [row['day'] for row in errors_by_date_sorted_df.select('day').collect()]\nerrors_404_by_day = [row['count'] for row in errors_by_date_sorted_df.select('count').collect()]\n\nprint days_with_errors_404\nprint errors_404_by_day","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881068E12,"submitTime":1.467681881068E12,"finishTime":1.467681905884E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f8e04d8e-e4a0-4832-8447-164d837860b1"},{"version":"CommandV1","origId":944615974881804,"guid":"ad6ba0eb-944d-481a-b6f1-e96ffd8d57e7","subtype":"command","commandType":"auto","position":114.0,"command":"# TEST Visualizing the 404 Response Codes by Day (4f)\nTest.assertEquals(days_with_errors_404, [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'incorrect days_with_errors_404')\nTest.assertEquals(errors_404_by_day, [243, 303, 346, 234, 372, 532, 381, 279, 314, 263, 195, 216, 287, 326, 258, 269, 255, 207, 312, 305, 288], 'incorrect errors_404_by_day')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881089E12,"submitTime":1.467681881089E12,"finishTime":1.467681905885E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e9a4ede4-0960-4b6a-971c-bfca9d0f9c90"},{"version":"CommandV1","origId":944615974881805,"guid":"66438c90-21ef-4814-8523-894dcecc5f3e","subtype":"command","commandType":"auto","position":115.0,"command":"fig, ax = prepareSubplot(np.arange(0, 20, 5), np.arange(0, 600, 100))\ncolorMap = 'rainbow'\ncmap = cm.get_cmap(colorMap)\nplt.plot(days_with_errors_404, errors_404_by_day, color=cmap(0), linewidth=3)\nplt.axis([0, max(days_with_errors_404), 0, max(errors_404_by_day)])\nplt.xlabel('Day')\nplt.ylabel('404 Errors')\nplt.axhline(linewidth=3, color='#999999')\nplt.axvline(linewidth=2, color='#999999')\ndisplay(fig)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881112E12,"submitTime":1.467681881112E12,"finishTime":1.467681905886E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ce6dd3f3-dc05-44ae-9ccc-b27636c94aea"},{"version":"CommandV1","origId":944615974881806,"guid":"a0a38d9b-0841-4a7d-b08c-5c460dcc76b4","subtype":"command","commandType":"auto","position":116.0,"command":"%md\nUsing the results from exercise (5e), use the Databricks `display` function to plot a line or bar graph of the 404 response codes by day.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881133E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"bf67983b-aa47-4eda-9bab-e5fd3b6c87f3"},{"version":"CommandV1","origId":944615974881807,"guid":"fba52ba9-d1a7-4f42-a394-ea97578dc07a","subtype":"command","commandType":"auto","position":117.0,"command":"display(errors_by_date_sorted_df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881155E12,"submitTime":1.467681881155E12,"finishTime":1.467681905887E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7a6f817c-2b69-460b-9592-ab435920042e"},{"version":"CommandV1","origId":944615974881808,"guid":"7b040ef6-2c58-4014-bca5-325eff6c4603","subtype":"command","commandType":"auto","position":118.0,"command":"%md\n### (5g) Exercise: Top Five Days for 404 Errors\n\nUsing the DataFrame `errors_by_date_sorted_df` you cached in the part (5e), what are the top five days for 404 errors and the corresponding counts of 404 errors?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881177E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e5897766-cd88-4632-aefe-994f29fff397"},{"version":"CommandV1","origId":944615974881809,"guid":"b67acd8d-c067-45f0-bc8c-409fb57aa6db","subtype":"command","commandType":"auto","position":119.0,"command":"top_err_date_df = errors_by_date_sorted_df.sort('count', ascending=False)\n\nprint 'Top Five Dates for 404 Requests:\\n'\ntop_err_date_df.show(5)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881198E12,"submitTime":1.467681881198E12,"finishTime":1.467681905887E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"652f6d40-6171-4dfa-9c9c-0f1014b4776e"},{"version":"CommandV1","origId":944615974881810,"guid":"5a288c78-484c-4e4b-9934-4e7de9a42746","subtype":"command","commandType":"auto","position":120.0,"command":"# TEST Five dates for 404 requests (4g)\n\nTest.assertEquals([(r[0], r[1]) for r in top_err_date_df.take(5)], [(7, 532), (8, 381), (6, 372), (4, 346), (15, 326)], 'incorrect top_err_date_df')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881219E12,"submitTime":1.467681881219E12,"finishTime":1.467681905888E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7214d28f-5579-4fec-8197-88b44db158f5"},{"version":"CommandV1","origId":944615974881811,"guid":"6aee7968-05cd-44e6-ae8e-232ac882d9e2","subtype":"command","commandType":"auto","position":121.0,"command":"%md\n### (5h) Exercise: Hourly 404 Errors\n\nUsing the DataFrame `not_found_df` you cached in the part (5a) and sorting by hour of the day in increasing order, create a DataFrame containing the number of requests that had a 404 return code for each hour of the day (midnight starts at 0). Cache the resulting DataFrame `hour_records_sorted_df` and print that as a list.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46768188124E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2f50dd48-8b57-4e7c-b18b-74dabe4b1cf2"},{"version":"CommandV1","origId":944615974881812,"guid":"9dffc080-d74a-4da9-8a82-91ff1bdf7e96","subtype":"command","commandType":"auto","position":122.0,"command":"from pyspark.sql.functions import hour\nhour_records_sorted_df = not_found_df.select(hour('time').alias('hour')).groupBy('hour').count()\n\nprint 'Top hours for 404 requests:\\n'\nhour_records_sorted_df.show(24)\nhour_records_sorted_df.cache()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881262E12,"submitTime":1.467681881262E12,"finishTime":1.467681905889E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d4922d8b-51ce-4e3b-ae45-16171d0aa5a0"},{"version":"CommandV1","origId":944615974881813,"guid":"09b6168b-46a5-4ec2-aa17-3f37e4830bfe","subtype":"command","commandType":"auto","position":123.0,"command":"# TEST Hourly 404 response codes (5h)\n\nerrs_by_hour = [(row[0], row[1]) for row in hour_records_sorted_df.collect()]\n\nexpected = [\n  (0, 175),\n  (1, 171),\n  (2, 422),\n  (3, 272),\n  (4, 102),\n  (5, 95),\n  (6, 93),\n  (7, 122),\n  (8, 199),\n  (9, 185),\n  (10, 329),\n  (11, 263),\n  (12, 438),\n  (13, 397),\n  (14, 318),\n  (15, 347),\n  (16, 373),\n  (17, 330),\n  (18, 268),\n  (19, 269),\n  (20, 270),\n  (21, 241),\n  (22, 234),\n  (23, 272)\n]\nTest.assertEquals(errs_by_hour, expected, 'incorrect errs_by_hour')\nTest.assertTrue(hour_records_sorted_df.is_cached, 'incorrect hour_records_sorted_df.is_cached')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881282E12,"submitTime":1.467681881282E12,"finishTime":1.467681905889E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a0e5edba-acf4-4e31-9efc-57fd3010cee1"},{"version":"CommandV1","origId":944615974881814,"guid":"217b23c4-a9c9-4679-89d9-6c620bfd698e","subtype":"command","commandType":"auto","position":124.0,"command":"%md\n### (5i) Exercise: Visualizing the 404 Response Codes by Hour\n\nUsing the results from the previous exercise, use `matplotlib` to plot a line or bar graph of the 404 response codes by hour.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881304E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c329c005-717a-4133-8397-4160c8393bfe"},{"version":"CommandV1","origId":944615974881815,"guid":"05da200e-e2ac-44ab-99f6-fe9f94615a8d","subtype":"command","commandType":"auto","position":125.0,"command":"hours_with_not_found = [row['hour'] for row in hour_records_sorted_df.select('hour').collect()]\nnot_found_counts_per_hour = [row['count'] for row in hour_records_sorted_df.select('count').collect()]\n\nprint hours_with_not_found\nprint not_found_counts_per_hour","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881325E12,"submitTime":1.467681881325E12,"finishTime":1.46768190589E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"71a24994-ffad-474e-878b-eff5ffcf4b4b"},{"version":"CommandV1","origId":944615974881816,"guid":"ac219c18-0ddb-439c-9dbd-654595f9e85e","subtype":"command","commandType":"auto","position":126.0,"command":"# TEST Visualizing the 404 Response Codes by Hour (5i)\nTest.assertEquals(hours_with_not_found, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 'incorrect hours_with_not_found')\nTest.assertEquals(not_found_counts_per_hour, [175, 171, 422, 272, 102, 95, 93, 122, 199, 185, 329, 263, 438, 397, 318, 347, 373, 330, 268, 269, 270, 241, 234, 272], 'incorrect not_found_counts_per_hour')","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881345E12,"submitTime":1.467681881345E12,"finishTime":1.467681905891E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c6100821-1ad8-41f7-a2f7-52920cc78ec8"},{"version":"CommandV1","origId":944615974881817,"guid":"63e55b93-dc73-450b-b07c-de5d525404f0","subtype":"command","commandType":"auto","position":127.0,"command":"fig, ax = prepareSubplot(np.arange(0, 25, 5), np.arange(0, 500, 50))\ncolorMap = 'seismic'\ncmap = cm.get_cmap(colorMap)\nplt.plot(hours_with_not_found, not_found_counts_per_hour, color=cmap(0), linewidth=3)\nplt.axis([0, max(hours_with_not_found), 0, max(not_found_counts_per_hour)])\nplt.xlabel('Hour')\nplt.ylabel('404 Errors')\nplt.axhline(linewidth=3, color='#999999')\nplt.axvline(linewidth=2, color='#999999')\ndisplay(fig)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881367E12,"submitTime":1.467681881367E12,"finishTime":1.467681905891E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2753f64c-6ae8-42d1-ba62-4f33d8e7f591"},{"version":"CommandV1","origId":944615974881818,"guid":"b5f055ce-b0a9-4ca4-a9ea-332604c1ed8f","subtype":"command","commandType":"auto","position":128.0,"command":"%md\nUsing the Databricks `display` function and the results from exercise (5h), plot a line or bar graph of the 404 response codes by hour.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46768188139E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"822b9359-3657-4646-9b64-4b5570683cb5"},{"version":"CommandV1","origId":944615974881819,"guid":"c76b2c0c-f02e-4498-b74d-975d9bdc95b5","subtype":"command","commandType":"auto","position":129.0,"command":"display(hour_records_sorted_df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.467681881412E12,"submitTime":1.467681881412E12,"finishTime":1.467681905892E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"124271df-df1d-465c-8fd0-91266b396ca2"},{"version":"CommandV1","origId":944615974881820,"guid":"0b77ff19-3f78-4809-90f5-e613bf91f931","subtype":"command","commandType":"auto","position":130.0,"command":"%md\n## Appendix A: Submitting Your Exercises to the Autograder\nOnce you confirm that your lab notebook is passing all tests, you can submit it first to the course autograder and then second to the edX website to receive a grade.\n<img src=\"https://d37djvu3ytnwxt.cloudfront.net/asset-v1:BerkeleyX+CS105x+1T2016+type@asset+block/url-process.png\" alt=\"Drawing\" style=\"float:right\"/>\n\n** Note that you can only submit to the course autograder once every 1 minute. **","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881434E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2f7ac4ed-6baa-4e77-8055-b25b2d913ad6"},{"version":"CommandV1","origId":944615974881821,"guid":"fad7a326-0ad7-4fec-84d7-86c0a9d7b752","subtype":"command","commandType":"auto","position":131.0,"command":"%md\n** (a) Restart your cluster by clicking on the dropdown next to your cluster name and selecting \"Restart Cluster\".**\n\nYou can do this step in either notebook, since there is one cluster for your notebooks.\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/submit_restart.png\" alt=\"Drawing\" />","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881456E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8babf4b2-c760-46b8-bda4-3ed8e512a33f"},{"version":"CommandV1","origId":944615974881822,"guid":"3b2173f9-5efb-401f-a321-702240413d26","subtype":"command","commandType":"auto","position":132.0,"command":"%md\n** (b) _IN THIS NOTEBOOK_, click on \"Run All\" to run all of the cells. **\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/submit_runall.png\" alt=\"Drawing\" style=\"height: 80px\"/>\n\nThis step will take some time. While the cluster is running all the cells in your lab notebook, you will see the \"Stop Execution\" button.\n\n <img src=\"http://spark-mooc.github.io/web-assets/images/stop_execution.png\" alt=\"Drawing\" />\n\nWait for your cluster to finish running the cells in your lab notebook before proceeding.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881477E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c52dfbd8-4c36-400f-a39c-7378b85661bf"},{"version":"CommandV1","origId":944615974881823,"guid":"dfcd907a-5682-46e6-98ff-6374df628553","subtype":"command","commandType":"auto","position":133.0,"command":"%md\n** (c) Verify that your LAB notebook passes as many tests as you can. **\n\nMost computations should complete within a few seconds unless stated otherwise. As soon as the expressions of a cell have been successfully evaluated, you will see one or more \"test passed\" messages if the cell includes test expressions:\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/test_passed.png\" alt=\"Drawing\" />\n\nIf the cell contains `print` statements or `show()` actions, you'll also see the output from those operations.\n\nThe very last line of output is always the execution time:\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/execution_time.png\" alt=\"Drawing\" />","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881497E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b2f8f2ee-840f-4812-a9f4-0b6f2f0e4c1a"},{"version":"CommandV1","origId":944615974881824,"guid":"c81d9d88-9181-4dc6-aaa5-3bb497e9efe0","subtype":"command","commandType":"auto","position":134.0,"command":"%md\n** (d) Publish your LAB notebook(this notebook) by clicking on the \"Publish\" button at the top of your LAB notebook. **\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/Lab0_Publish0.png\" alt=\"Drawing\" style=\"height: 150px\"/>\n\nWhen you click on the button, you will see the following popup.\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/Lab0_Publish1.png\" alt=\"Drawing\" />\n\nWhen you click on \"Publish\", you will see a popup with your notebook's public link. **Copy the link and set the `notebook_URL` variable in the AUTOGRADER notebook (not this notebook).**\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/Lab0_Publish2.png\" alt=\"Drawing\" />","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.467681881518E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2c39249b-e174-49d1-807d-c7b75b9f3c5b"}],"dashboards":[],"guid":"1bb638ab-7526-4f45-bf52-fab59dcc9950","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
